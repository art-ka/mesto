(()=>{"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var t=function(){function t(e,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=e,this._link=n,this._template=r,this._handleCardClick=o}var n,r;return n=t,(r=[{key:"generateCard",value:function(){return this._element=this._template,this._image=this._element.querySelector(".element__image"),this._image.src=this._link,this._image.alt=this._name,this._element.querySelector(".element__title").textContent=this._name,this._setEventListeners(),this._element}},{key:"_handleDeleteCard",value:function(){this._element.remove()}},{key:"_setEventListeners",value:function(){var e=this;this._element.querySelector(".element__delete-button").addEventListener("click",(function(){e._handleDeleteCard()})),this._element.querySelector(".element__like-image").addEventListener("click",(function(e){e.target.classList.toggle("element__like-image-active")})),this._image.addEventListener("click",(function(){return e._handleCardClick({name:e._name,link:e._link})}))}}])&&e(n.prototype,r),t}(),n={formSelector:".popup__form",inputSelector:".popup__field",formAdd:".popup_type_add",formEdit:".popup_type_edit",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button-disabled",inputErrorClass:"popup__field-error",errorClass:"popup__field-error-active"},r=(document.querySelector(".popup__image"),document.querySelector(".popup__caption"),document.querySelector(".popup_type_add")),o=document.querySelector(".profile__edit-button"),i=document.querySelector(".profile__add-button");function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._formElement=document.querySelector(n),this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass}var t,n;return t=e,(n=[{key:"_showInputError",value:function(e,t){var n=this._formElement.querySelector("#".concat(e.id,"-error"));n.classList.add(this._errorClass),n.textContent=t}},{key:"_hideInputError",value:function(e){var t=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.remove(this._errorClass),t.textContent=""}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_hasInvalidInput",value:function(e){return e.some((function(e){return!e.validity.valid}))}},{key:"toggleButtonState",value:function(e,t){this._hasInvalidInput(e)?(t.classList.add(this._inactiveButtonClass),t.setAttribute("disabled",!0)):(t.classList.remove(this._inactiveButtonClass),t.removeAttribute("disabled"))}},{key:"_setEventListeners",value:function(){var e=this,t=Array.from(this._formElement.querySelectorAll(this._inputSelector)),n=this._formElement.querySelector(this._submitButtonSelector);t.forEach((function(r){r.addEventListener("input",(function(){e._checkInputValidity(r),e.toggleButtonState(t,n)}))}))}},{key:"enableValidation",value:function(){this._formElement.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}}])&&u(t.prototype,n),e}();function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(t,n){var r=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._renderedItems=r,this._renderer=o,this._container=document.querySelector(n)}var t,n;return t=e,(n=[{key:"renderItems",value:function(){var e=this;this._renderedItems.forEach((function(t){return e._renderer(t)}))}},{key:"addItem",value:function(e){this._container.prepend(e)}}])&&a(t.prototype,n),e}();function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popup=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}var t,n;return t=e,(n=[{key:"open",value:function(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"_handleEscClose",value:function(){var e=this;this._popup.classList.contains("popup_opened")?document.addEventListener("keydown",(function(t){"Escape"===t.key&&e.close()})):document.removeEventListener("keydown",(function(t){"Escape"===t.key&&e.close()}))}},{key:"setEventListeners",value:function(e){var t=this;this._popup.querySelector(".popup__close").addEventListener("click",(function(){return t.close()})),this._popup.addEventListener("click",(function(e){e.target===e.currentTarget&&t.close(e.currentTarget)}))}}])&&s(t.prototype,n),e}();function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t,n){return(y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(r);if(o){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return m(this,e)});function u(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),i.call(this,e)}return t=u,(n=[{key:"open",value:function(e,t){this._popupImage=document.querySelector(".popup__image"),this._popupTitle=document.querySelector(".popup__caption"),this._popupImage.src=t,this._popupTitle.textContent=e,y(h(u.prototype),"open",this).call(this)}}])&&d(t.prototype,n),u}(p);function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function k(e,t,n){return(k="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=w(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(e,t){return!t||"object"!==b(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=w(r);if(o){var n=w(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return E(this,e)});function u(e){var t,n=e.popupSelector,r=e.handleFormSubmit;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=i.call(this,n))._handleFormSubmit=r,t}return t=u,(n=[{key:"_getInputValues",value:function(){var e=this,t=document.querySelectorAll(".popup__field");return this._inputValues={},t.forEach((function(t){e._inputValues[t.name]=t.value})),this._inputValues}},{key:"close",value:function(){k(w(u.prototype),"close",this).call(this),this._popup.querySelector("form").reset()}},{key:"setEventListeners",value:function(e){var t=this;k(w(u.prototype),"setEventListeners",this).call(this,e),this._popup.addEventListener("submit",(function(e){e.preventDefault(),t._handleFormSubmit(t._getInputValues())}))}}])&&g(t.prototype,n),u}(p);function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var O=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.titleSelector=document.querySelector(".profile__title"),this.subtitleSelector=document.querySelector(".profile__subtitle")}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{name:this.titleSelector.textContent,jobInput:this.subtitleSelector.textContent}}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.job;this.titleSelector.textContent=t,this.subtitleSelector.textContent=n}}])&&j(t.prototype,n),e}()),L=new v(".popup_type_img");L.setEventListeners();var q=function(e){var t=e.name,n=e.link;L.open(t,n)},I=function(e){var n=e.name,r=e.link;return new t(n,r,document.querySelector("#elements").content.querySelector(".element__cards").cloneNode(!0),q).generateCard()},P=new l({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:function(e){var t=I({name:e.name,link:e.link});P.addItem(t)}},".element");P.renderItems();var x=new C({popupSelector:".popup_type_add",handleFormSubmit:function(e){var t=I({name:e.title,link:e.picture});P.addItem(t),x.close()}});x.setEventListeners(R),i.addEventListener("click",(function(){x.open();var e=Array.from(r.querySelectorAll(".popup__field")),t=r.querySelector(".popup__submit-button");T.toggleButtonState(e,t)}));var R=new C({popupSelector:".popup_type_edit",handleFormSubmit:function(e){O.setUserInfo({name:e.fullname,job:e.job}),R.close()}});o.addEventListener("click",(function(){var e=O.getUserInfo(),t=document.querySelector(".popup__field_input_name"),n=document.querySelector(".popup__field_input_job");t.value=e.name,n.value=e.jobInput,R.open()})),R.setEventListeners();var T=new c(n,n.formAdd);T.enableValidation(),new c(n,n.formEdit).enableValidation()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvdXRpbHMvY29uc3RhbnQuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvcGFnZXMvaW5kZXguanMiXSwibmFtZXMiOlsiQ2FyZCIsIm5hbWUiLCJsaW5rIiwidGVtcGxhdGUiLCJoYW5kbGVDYXJkQ2xpY2siLCJ0aGlzIiwiX25hbWUiLCJfbGluayIsIl90ZW1wbGF0ZSIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfZWxlbWVudCIsIl9pbWFnZSIsInF1ZXJ5U2VsZWN0b3IiLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsIl9zZXRFdmVudExpc3RlbmVycyIsInJlbW92ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlRGVsZXRlQ2FyZCIsImV2ZW50IiwidGFyZ2V0IiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwicGFyYW1zIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsImZvcm1BZGQiLCJmb3JtRWRpdCIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJwb3B1cEFkZCIsImRvY3VtZW50IiwicHJvZmlsZUVkaXRCdXR0b24iLCJhZGRDYXJkQnV0dG9uIiwiRm9ybVZhbGlkYXRvciIsImZvcm1FbGVtZW50IiwiX2Zvcm1FbGVtZW50IiwiX2lucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZSIsImVycm9yRWxlbWVudCIsImlkIiwiYWRkIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiaW5wdXRMaXN0Iiwic29tZSIsImJ1dHRvbkVsZW1lbnQiLCJfaGFzSW52YWxpZElucHV0Iiwic2V0QXR0cmlidXRlIiwicmVtb3ZlQXR0cmlidXRlIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJwcmV2ZW50RGVmYXVsdCIsIlNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfcmVuZGVyZWRJdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJpdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXAiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImNvbnRhaW5zIiwiZXZ0Iiwia2V5IiwiY2xvc2UiLCJwb3B1cCIsImN1cnJlbnRUYXJnZXQiLCJQb3B1cFdpdGhJbWFnZSIsIl9wb3B1cEltYWdlIiwiX3BvcHVwVGl0bGUiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsIl9oYW5kbGVGb3JtU3VibWl0IiwidXNlcklucHV0cyIsIl9pbnB1dFZhbHVlcyIsInZhbHVlIiwicmVzZXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJ1c2VySW5mbyIsInRpdGxlU2VsZWN0b3IiLCJzdWJ0aXRsZVNlbGVjdG9yIiwiam9iSW5wdXQiLCJqb2IiLCJwb3B1cEltYWdlIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJvcGVuIiwiZ2V0Q2FyZEVsZW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiZ2VuZXJhdGVDYXJkIiwiY2FyZHNMaXN0IiwiY2FyZEVsZW1lbnQiLCJhZGRJdGVtIiwicmVuZGVySXRlbXMiLCJpbnB1dFZhbHVlcyIsInRpdGxlIiwicGljdHVyZSIsImZvcm1BZGRWYWxpZGF0b3IiLCJpbnB1dHNWYWx1ZXMiLCJzZXRVc2VySW5mbyIsImZ1bGxuYW1lIiwicHJvZmlsZSIsImdldFVzZXJJbmZvIiwiaW5wdXRzTmFtZSIsImlucHV0c0pvYiIsImVuYWJsZVZhbGlkYXRpb24iXSwibWFwcGluZ3MiOiJ5TEFBTyxJQUFNQSxFQUFiLFdBQ0ksV0FBWUMsRUFBTUMsRUFBTUMsRUFBVUMsSSw0RkFBaUIsU0FDL0NDLEtBQUtDLE1BQVFMLEVBQ2JJLEtBQUtFLE1BQVFMLEVBQ2JHLEtBQUtHLFVBQVlMLEVBQ2pCRSxLQUFLSSxpQkFBbUJMLEUsUUFMaEMsTyxFQUFBLEcsRUFBQSxzQ0FpQlEsT0FSQUMsS0FBS0ssU0FBV0wsS0FBS0csVUFDckJILEtBQUtNLE9BQVNOLEtBQUtLLFNBQVNFLGNBQWMsbUJBQzFDUCxLQUFLTSxPQUFPRSxJQUFNUixLQUFLRSxNQUN2QkYsS0FBS00sT0FBT0csSUFBTVQsS0FBS0MsTUFDdkJELEtBQUtLLFNBQVNFLGNBQWMsbUJBQW1CRyxZQUFjVixLQUFLQyxNQUVsRUQsS0FBS1cscUJBRUVYLEtBQUtLLFdBakJwQiwwQ0FxQlFMLEtBQUtLLFNBQVNPLFdBckJ0QiwyQ0F3QnlCLFdBQ2pCWixLQUFLSyxTQUNBRSxjQUFjLDJCQUNkTSxpQkFBaUIsU0FBUyxXQUN2QixFQUFLQyx1QkFHYmQsS0FBS0ssU0FDQUUsY0FBYyx3QkFDZE0saUJBQWlCLFNBQVMsU0FBQUUsR0FDdkJBLEVBQU1DLE9BQU9DLFVBQVVDLE9BQU8saUNBR3RDbEIsS0FBS00sT0FDQU8saUJBQWlCLFNBQVMsa0JBQU0sRUFBS1QsaUJBQWlCLENBQUVSLEtBQU0sRUFBS0ssTUFBT0osS0FBTSxFQUFLSyxnQixpQkF0Q2xHLEtDMkJhaUIsRUFBUyxDQUNsQkMsYUFBYyxlQUNkQyxjQUFlLGdCQUNmQyxRQUFTLGtCQUNUQyxTQUFVLG1CQUNWQyxxQkFBc0Isd0JBQ3RCQyxvQkFBcUIsZ0NBQ3JCQyxnQkFBaUIscUJBQ2pCQyxXQUFZLDZCQU1IQyxHQUhhQyxTQUFTdEIsY0FBYyxpQkFDdkJzQixTQUFTdEIsY0FBYyxtQkFFekJzQixTQUFTdEIsY0FBYyxvQkFFbEN1QixFQUFvQkQsU0FBU3RCLGNBQWMseUJBQzNDd0IsRUFBZ0JGLFNBQVN0QixjQUFjLHdCLHNLQzVDN0MsSUFBTXlCLEVBQWIsV0FDSSxXQUFZYixFQUFRYyxJLDRGQUFhLFNBQzdCakMsS0FBS2tDLGFBQWVMLFNBQVN0QixjQUFjMEIsR0FDM0NqQyxLQUFLbUMsZUFBaUJoQixFQUFPRSxjQUM3QnJCLEtBQUtvQyxzQkFBd0JqQixFQUFPSyxxQkFDcEN4QixLQUFLcUMscUJBQXVCbEIsRUFBT00sb0JBQ25DekIsS0FBS3NDLGlCQUFtQm5CLEVBQU9PLGdCQUMvQjFCLEtBQUt1QyxZQUFjcEIsRUFBT1EsVyxRQVBsQyxPLEVBQUEsRyxFQUFBLHVDQVVvQmEsRUFBY0MsR0FDMUIsSUFBTUMsRUFBZTFDLEtBQUtrQyxhQUFhM0IsY0FBbEIsV0FBb0NpQyxFQUFhRyxHQUFqRCxXQUVyQkQsRUFBYXpCLFVBQVUyQixJQUFJNUMsS0FBS3VDLGFBQ2hDRyxFQUFhaEMsWUFBYytCLElBZG5DLHNDQWlCb0JELEdBQ1osSUFBTUUsRUFBZTFDLEtBQUtrQyxhQUFhM0IsY0FBbEIsV0FBb0NpQyxFQUFhRyxHQUFqRCxXQUVyQkgsRUFBYXZCLFVBQVVMLE9BQU9aLEtBQUt1QyxhQUNuQ0csRUFBYWhDLFlBQWMsS0FyQm5DLDBDQXdCd0I4QixHQUNYQSxFQUFhSyxTQUFTQyxNQUd2QjlDLEtBQUsrQyxnQkFBZ0JQLEdBRnJCeEMsS0FBS2dELGdCQUFnQlIsRUFBY0EsRUFBYVMscUJBMUI1RCx1Q0FnQ3FCQyxHQUNiLE9BQU9BLEVBQVVDLE1BQUssU0FBQ1gsR0FBRCxPQUFtQkEsRUFBYUssU0FBU0MsV0FqQ3ZFLHdDQW9Dc0JJLEVBQVdFLEdBQ3JCcEQsS0FBS3FELGlCQUFpQkgsSUFDdEJFLEVBQWNuQyxVQUFVMkIsSUFBSTVDLEtBQUtxQyxzQkFDakNlLEVBQWNFLGFBQWEsWUFBWSxLQUV2Q0YsRUFBY25DLFVBQVVMLE9BQU9aLEtBQUtxQyxzQkFDcENlLEVBQWNHLGdCQUFnQixlQTFDMUMsMkNBOEN5QixXQUNYTCxFQUFZTSxNQUFNQyxLQUFLekQsS0FBS2tDLGFBQWF3QixpQkFBaUIxRCxLQUFLbUMsaUJBQy9EaUIsRUFBZ0JwRCxLQUFLa0MsYUFBYTNCLGNBQWNQLEtBQUtvQyx1QkFFM0RjLEVBQVVTLFNBQVEsU0FBQ25CLEdBQ2ZBLEVBQWEzQixpQkFBaUIsU0FBUyxXQUNuQyxFQUFLK0Msb0JBQW9CcEIsR0FDekIsRUFBS3FCLGtCQUFrQlgsRUFBV0UsV0FyRGxELHlDQThEUXBELEtBQUtrQyxhQUFhckIsaUJBQWlCLFVBSFQsU0FBQ0UsR0FDdkJBLEVBQU0rQyxvQkFJVjlELEtBQUtXLDBCLGlCQWhFYixLLHNLQ0FPLElBQU1vRCxFQUFiLFdBQ0ksYUFBaUNDLEdBQW1CLElBQXRDQyxFQUFzQyxFQUF0Q0EsTUFBT0MsRUFBK0IsRUFBL0JBLFUsNEZBQStCLFNBQ2hEbEUsS0FBS21FLGVBQWlCRixFQUN0QmpFLEtBQUtvRSxVQUFZRixFQUVqQmxFLEtBQUtxRSxXQUFheEMsU0FBU3RCLGNBQWN5RCxHLFFBTGpELE8sRUFBQSxHLEVBQUEscUNBUWtCLFdBQ1ZoRSxLQUFLbUUsZUFBZVIsU0FBUSxTQUFBVyxHQUFJLE9BQUksRUFBS0YsVUFBVUUsUUFUM0QsOEJBWVlDLEdBQ0p2RSxLQUFLcUUsV0FBV0csUUFBUUQsUSxpQkFiaEMsSyxzS0NDTyxJQUFNRSxFQUFiLFdBQ0ksV0FBWUMsSSw0RkFBZSxTQUN2QjFFLEtBQUsyRSxPQUFTOUMsU0FBU3RCLGNBQWNtRSxHQUNyQzFFLEtBQUs0RSxnQkFBa0I1RSxLQUFLNEUsZ0JBQWdCQyxLQUFLN0UsTSxRQUh6RCxPLEVBQUEsRyxFQUFBLDhCQU9RQSxLQUFLMkUsT0FBTzFELFVBQVUyQixJQUFJLGdCQUMxQmYsU0FBU2hCLGlCQUFpQixVQUFXYixLQUFLNEUsbUJBUmxELDhCQVlRNUUsS0FBSzJFLE9BQU8xRCxVQUFVTCxPQUFPLGdCQUM3QmlCLFNBQVNpRCxvQkFBb0IsVUFBVzlFLEtBQUs0RSxtQkFickQsd0NBZ0JzQixXQUNWNUUsS0FBSzJFLE9BQU8xRCxVQUFVOEQsU0FBUyxnQkFDL0JsRCxTQUFTaEIsaUJBQWlCLFdBQVcsU0FBQ21FLEdBQ2xCLFdBQVpBLEVBQUlDLEtBQ0osRUFBS0MsV0FJYnJELFNBQVNpRCxvQkFBb0IsV0FBVyxTQUFDRSxHQUNyQixXQUFaQSxFQUFJQyxLQUNKLEVBQUtDLGFBMUJ6Qix3Q0FnQ3NCQyxHQUFPLFdBQ0luRixLQUFLMkUsT0FBT3BFLGNBQWMsaUJBQ2xDTSxpQkFBaUIsU0FBUyxrQkFBTSxFQUFLcUUsV0FHdERsRixLQUFLMkUsT0FBTzlELGlCQUFpQixTQUFTLFNBQUNtRSxHQUMvQkEsRUFBSWhFLFNBQVdnRSxFQUFJSSxlQUl2QixFQUFLRixNQUFNRixFQUFJSSx1QixpQkExQzNCLEssOGtDQ0NPLElBQU1DLEVBQWIsYSxrT0FBQSxVLFFBQUEsRyxFQUFBLEUsMFlBQ0ksV0FBWVgsR0FBZSxPLDRGQUFBLHFCQUNqQkEsR0FGZCxPLEVBQUEsRyxFQUFBLDRCQUtTOUUsRUFBTUMsR0FDUEcsS0FBS3NGLFlBQWN6RCxTQUFTdEIsY0FBYyxpQkFDMUNQLEtBQUt1RixZQUFjMUQsU0FBU3RCLGNBQWMsbUJBQzFDUCxLQUFLc0YsWUFBWTlFLElBQU1YLEVBQ3ZCRyxLQUFLdUYsWUFBWTdFLFlBQWNkLEVBQy9CLDhDLGlCQVZSLEdBQW9DNkUsRyw4a0NDQTdCLElBQU1lLEVBQWIsYSxrT0FBQSxVLFFBQUEsRyxFQUFBLEUsMFlBQ0ksY0FBaUQsTUFBbkNkLEVBQW1DLEVBQW5DQSxjQUFlZSxFQUFvQixFQUFwQkEsaUJBQW9CLE8sNEZBQUEsVUFDN0MsY0FBTWYsSUFDRGdCLGtCQUFvQkQsRUFGb0IsRUFEckQsTyxFQUFBLEcsRUFBQSx5Q0FNc0IsV0FDUkUsRUFBYTlELFNBQVM2QixpQkFBaUIsaUJBSzdDLE9BSkExRCxLQUFLNEYsYUFBZSxHQUNwQkQsRUFBV2hDLFNBQVEsU0FBQ1csR0FDaEIsRUFBS3NCLGFBQWF0QixFQUFLMUUsTUFBUTBFLEVBQUt1QixTQUVqQzdGLEtBQUs0RixlQVpwQiw4QkFnQlEsMENBQ0E1RixLQUFLMkUsT0FBT3BFLGNBQWMsUUFBUXVGLFVBakIxQyx3Q0FvQnNCWCxHQUFPLFdBQ3JCLHFEQUF3QkEsR0FDeEJuRixLQUFLMkUsT0FBTzlELGlCQUFpQixVQUFVLFNBQUNtRSxHQUNwQ0EsRUFBSWxCLGlCQUNKLEVBQUs0QixrQkFBa0IsRUFBS0ssMkIsaUJBeEJ4QyxHQUFtQ3RCLEcsc0tDRjVCLElDU0R1QixFQUFXLElEVGpCLFdBQ0ksYyw0RkFBYyxTQUNWaEcsS0FBS2lHLGNBQWdCcEUsU0FBU3RCLGNBQWMsbUJBQzVDUCxLQUFLa0csaUJBQW1CckUsU0FBU3RCLGNBQWMsc0IsUUFIdkQsTyxFQUFBLEcsRUFBQSxxQ0FPUSxNQUFPLENBQ0hYLEtBQU1JLEtBQUtpRyxjQUFjdkYsWUFDekJ5RixTQUFVbkcsS0FBS2tHLGlCQUFpQnhGLGVBVDVDLHFDQWErQixJQUFiZCxFQUFhLEVBQWJBLEtBQU13RyxFQUFPLEVBQVBBLElBQ2hCcEcsS0FBS2lHLGNBQWN2RixZQUFjZCxFQUNqQ0ksS0FBS2tHLGlCQUFpQnhGLFlBQWMwRixPLGlCQWY1QyxNQ2lCTUMsRUFBYSxJQUFJaEIsRUFBZSxtQkFDdENnQixFQUFXQyxvQkFFWCxJQUFNdkcsRUFBa0IsU0FBQyxHQUFtQixJQUFqQkgsRUFBaUIsRUFBakJBLEtBQU1DLEVBQVcsRUFBWEEsS0FDN0J3RyxFQUFXRSxLQUFLM0csRUFBTUMsSUFHcEIyRyxFQUFpQixTQUFDLEdBQW1CLElBQWpCNUcsRUFBaUIsRUFBakJBLEtBQU1DLEVBQVcsRUFBWEEsS0FFNUIsT0FEYSxJQUFJRixFQUFLQyxFQUFNQyxFQWRHZ0MsU0FDOUJ0QixjQUFjLGFBQ2RrRyxRQUNBbEcsY0FBYyxtQkFDZG1HLFdBQVUsR0FVK0MzRyxHQUM5QzRHLGdCQUdWQyxFQUFZLElBQUk3QyxFQUFRLENBQzFCRSxNUDlCd0IsQ0FDeEIsQ0FDSXJFLEtBQU0sUUFDTkMsS0FBTSxpRkFFVixDQUNJRCxLQUFNLHNCQUNOQyxLQUFNLDZGQUVWLENBQ0lELEtBQU0sVUFDTkMsS0FBTSxrRkFFVixDQUNJRCxLQUFNLFdBQ05DLEtBQU0sb0ZBRVYsQ0FDSUQsS0FBTSxxQkFDTkMsS0FBTSw2RkFFVixDQUNJRCxLQUFNLFNBQ05DLEtBQU0sa0ZPUVZxRSxTQUFVLFNBQUNJLEdBQ1AsSUFBTXVDLEVBQWNMLEVBQWUsQ0FBQzVHLEtBQU0wRSxFQUFLMUUsS0FBTUMsS0FBTXlFLEVBQUt6RSxPQUNoRStHLEVBQVVFLFFBQVFELEtBR3RCLFlBR0pELEVBQVVHLGNBRVYsSUFBTXpGLEVBQVUsSUFBSWtFLEVBQWMsQ0FDOUJkLGNBQWUsa0JBQ2ZlLGlCQUFrQixTQUFDdUIsR0FDZixJQUFNSCxFQUFjTCxFQUFlLENBQUU1RyxLQUFNb0gsRUFBWUMsTUFBT3BILEtBQU1tSCxFQUFZRSxVQUNoRk4sRUFBVUUsUUFBUUQsR0FDbEJ2RixFQUFRNEQsV0FJaEI1RCxFQUFRZ0Ysa0JBQWtCL0UsR0FFMUJRLEVBQWNsQixpQkFBaUIsU0FBUyxXQUNwQ1MsRUFBUWlGLE9BRVIsSUFBTXJELEVBQVlNLE1BQU1DLEtBQUs3QixFQUFTOEIsaUJBQWlCLGtCQUNqRE4sRUFBZ0J4QixFQUFTckIsY0FBYyx5QkFFN0M0RyxFQUFpQnRELGtCQUFrQlgsRUFBV0UsTUFHbEQsSUFBTTdCLEVBQVcsSUFBSWlFLEVBQWMsQ0FDL0JkLGNBQWUsbUJBQ2ZlLGlCQUFrQixTQUFDMkIsR0FDZnBCLEVBQVNxQixZQUFZLENBQUV6SCxLQUFNd0gsRUFBYUUsU0FBVWxCLElBQUtnQixFQUFhaEIsTUFDdEU3RSxFQUFTMkQsV0FLakJwRCxFQUFrQmpCLGlCQUFpQixTQUFTLFdBQ3hDLElBQU0wRyxFQUFVdkIsRUFBU3dCLGNBQ25CQyxFQUFhNUYsU0FBU3RCLGNBQWMsNEJBQ3BDbUgsRUFBWTdGLFNBQVN0QixjQUFjLDJCQUV6Q2tILEVBQVc1QixNQUFRMEIsRUFBUTNILEtBQzNCOEgsRUFBVTdCLE1BQVEwQixFQUFRcEIsU0FFMUI1RSxFQUFTZ0YsVUFHYmhGLEVBQVMrRSxvQkFFVCxJQUFNYSxFQUFtQixJQUFJbkYsRUFBY2IsRUFBUUEsRUFBT0csU0FDMUQ2RixFQUFpQlEsbUJBRVMsSUFBSTNGLEVBQWNiLEVBQVFBLEVBQU9JLFVBQ3pDb0csb0IiLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBjbGFzcyBDYXJkIHtcbiAgICBjb25zdHJ1Y3RvcihuYW1lLCBsaW5rLCB0ZW1wbGF0ZSwgaGFuZGxlQ2FyZENsaWNrKSB7XG4gICAgICAgIHRoaXMuX25hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLl9saW5rID0gbGluaztcbiAgICAgICAgdGhpcy5fdGVtcGxhdGUgPSB0ZW1wbGF0ZTtcbiAgICAgICAgdGhpcy5faGFuZGxlQ2FyZENsaWNrID0gaGFuZGxlQ2FyZENsaWNrO1xuICAgIH1cblxuICAgIGdlbmVyYXRlQ2FyZCgpIHtcbiAgICAgICAgdGhpcy5fZWxlbWVudCA9IHRoaXMuX3RlbXBsYXRlO1xuICAgICAgICB0aGlzLl9pbWFnZSA9IHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX2ltYWdlJyk7XG4gICAgICAgIHRoaXMuX2ltYWdlLnNyYyA9IHRoaXMuX2xpbms7XG4gICAgICAgIHRoaXMuX2ltYWdlLmFsdCA9IHRoaXMuX25hbWU7XG4gICAgICAgIHRoaXMuX2VsZW1lbnQucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX3RpdGxlJykudGV4dENvbnRlbnQgPSB0aGlzLl9uYW1lO1xuXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG5cbiAgICAgICAgcmV0dXJuIHRoaXMuX2VsZW1lbnQ7XG4gICAgfVxuXG4gICAgX2hhbmRsZURlbGV0ZUNhcmQoKSB7XG4gICAgICAgIHRoaXMuX2VsZW1lbnQucmVtb3ZlKCk7XG4gICAgfVxuXG4gICAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgICAgICB0aGlzLl9lbGVtZW50XG4gICAgICAgICAgICAucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX2RlbGV0ZS1idXR0b24nKVxuICAgICAgICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNhcmQoKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuX2VsZW1lbnRcbiAgICAgICAgICAgIC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9fbGlrZS1pbWFnZScpXG4gICAgICAgICAgICAuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBldmVudCA9PiB7XG4gICAgICAgICAgICAgICAgZXZlbnQudGFyZ2V0LmNsYXNzTGlzdC50b2dnbGUoJ2VsZW1lbnRfX2xpa2UtaW1hZ2UtYWN0aXZlJyk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLl9pbWFnZVxuICAgICAgICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5faGFuZGxlQ2FyZENsaWNrKHsgbmFtZTogdGhpcy5fbmFtZSwgbGluazogdGhpcy5fbGlua30pKTtcbiAgICB9XG59ICIsImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gICAge1xuICAgICAgICBuYW1lOiAn0JDRgNGF0YvQtycsXG4gICAgICAgIGxpbms6ICdodHRwczovL3BpY3R1cmVzLnMzLnlhbmRleC5uZXQvZnJvbnRlbmQtZGV2ZWxvcGVyL2NhcmRzLWNvbXByZXNzZWQvYXJraHl6LmpwZydcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogJ9Cn0LXQu9GP0LHQuNC90YHQutCw0Y8g0L7QsdC70LDRgdGC0YwnLFxuICAgICAgICBsaW5rOiAnaHR0cHM6Ly9waWN0dXJlcy5zMy55YW5kZXgubmV0L2Zyb250ZW5kLWRldmVsb3Blci9jYXJkcy1jb21wcmVzc2VkL2NoZWx5YWJpbnNrLW9ibGFzdC5qcGcnXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6ICfQmNCy0LDQvdC+0LLQvicsXG4gICAgICAgIGxpbms6ICdodHRwczovL3BpY3R1cmVzLnMzLnlhbmRleC5uZXQvZnJvbnRlbmQtZGV2ZWxvcGVyL2NhcmRzLWNvbXByZXNzZWQvaXZhbm92by5qcGcnXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6ICfQmtCw0LzRh9Cw0YLQutCwJyxcbiAgICAgICAgbGluazogJ2h0dHBzOi8vcGljdHVyZXMuczMueWFuZGV4Lm5ldC9mcm9udGVuZC1kZXZlbG9wZXIvY2FyZHMtY29tcHJlc3NlZC9rYW1jaGF0a2EuanBnJ1xuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiAn0KXQvtC70LzQvtCz0L7RgNGB0LrQuNC5INGA0LDQudC+0L0nLFxuICAgICAgICBsaW5rOiAnaHR0cHM6Ly9waWN0dXJlcy5zMy55YW5kZXgubmV0L2Zyb250ZW5kLWRldmVsb3Blci9jYXJkcy1jb21wcmVzc2VkL2tob2xtb2dvcnNreS1yYXlvbi5qcGcnXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6ICfQkdCw0LnQutCw0LsnLFxuICAgICAgICBsaW5rOiAnaHR0cHM6Ly9waWN0dXJlcy5zMy55YW5kZXgubmV0L2Zyb250ZW5kLWRldmVsb3Blci9jYXJkcy1jb21wcmVzc2VkL2JhaWthbC5qcGcnXG4gICAgfVxuXTtcblxuZXhwb3J0IGNvbnN0IHBhcmFtcyA9IHtcbiAgICBmb3JtU2VsZWN0b3I6ICcucG9wdXBfX2Zvcm0nLFxuICAgIGlucHV0U2VsZWN0b3I6ICcucG9wdXBfX2ZpZWxkJyxcbiAgICBmb3JtQWRkOiAnLnBvcHVwX3R5cGVfYWRkJyxcbiAgICBmb3JtRWRpdDogJy5wb3B1cF90eXBlX2VkaXQnLFxuICAgIHN1Ym1pdEJ1dHRvblNlbGVjdG9yOiAnLnBvcHVwX19zdWJtaXQtYnV0dG9uJyxcbiAgICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiAncG9wdXBfX3N1Ym1pdC1idXR0b24tZGlzYWJsZWQnLFxuICAgIGlucHV0RXJyb3JDbGFzczogJ3BvcHVwX19maWVsZC1lcnJvcicsXG4gICAgZXJyb3JDbGFzczogJ3BvcHVwX19maWVsZC1lcnJvci1hY3RpdmUnXG59XG5cbmV4cG9ydCBjb25zdCBwb3B1cEltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19pbWFnZScpO1xuZXhwb3J0IGNvbnN0IHBvcHVwVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2NhcHRpb24nKTtcblxuZXhwb3J0IGNvbnN0IHBvcHVwQWRkID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX3R5cGVfYWRkJyk7XG5cbmV4cG9ydCBjb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19lZGl0LWJ1dHRvbicpO1xuZXhwb3J0IGNvbnN0IGFkZENhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fYWRkLWJ1dHRvbicpOyIsImV4cG9ydCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgICBjb25zdHJ1Y3RvcihwYXJhbXMsIGZvcm1FbGVtZW50KSB7XG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihmb3JtRWxlbWVudCk7XG4gICAgICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSBwYXJhbXMuaW5wdXRTZWxlY3RvcjtcbiAgICAgICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSBwYXJhbXMuc3VibWl0QnV0dG9uU2VsZWN0b3I7XG4gICAgICAgIHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MgPSBwYXJhbXMuaW5hY3RpdmVCdXR0b25DbGFzcztcbiAgICAgICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gcGFyYW1zLmlucHV0RXJyb3JDbGFzcztcbiAgICAgICAgdGhpcy5fZXJyb3JDbGFzcyA9IHBhcmFtcy5lcnJvckNsYXNzO1xuICAgIH1cblxuICAgIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQsIGVycm9yTWVzc2FnZSkge1xuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG5cbiAgICAgICAgZXJyb3JFbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5fZXJyb3JDbGFzcyk7XG4gICAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9IGVycm9yTWVzc2FnZTtcbiAgICB9O1xuXG4gICAgX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCkge1xuICAgICAgICBjb25zdCBlcnJvckVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKGAjJHtpbnB1dEVsZW1lbnQuaWR9LWVycm9yYCk7XG5cbiAgICAgICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gICAgICAgIGVycm9yRWxlbWVudC50ZXh0Q29udGVudCA9ICcnO1xuICAgIH07XG5cbiAgICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgICAgICBpZiAoIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCkge1xuICAgICAgICAgICAgdGhpcy5fc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBpbnB1dEVsZW1lbnQudmFsaWRhdGlvbk1lc3NhZ2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5faGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBfaGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkge1xuICAgICAgICByZXR1cm4gaW5wdXRMaXN0LnNvbWUoKGlucHV0RWxlbWVudCkgPT4gIWlucHV0RWxlbWVudC52YWxpZGl0eS52YWxpZCk7XG4gICAgfTtcblxuICAgIHRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCkge1xuICAgICAgICBpZiAodGhpcy5faGFzSW52YWxpZElucHV0KGlucHV0TGlzdCkpIHtcbiAgICAgICAgICAgIGJ1dHRvbkVsZW1lbnQuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICAgICAgICAgIGJ1dHRvbkVsZW1lbnQuc2V0QXR0cmlidXRlKFwiZGlzYWJsZWRcIiwgdHJ1ZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICAgICAgICBidXR0b25FbGVtZW50LnJlbW92ZUF0dHJpYnV0ZShcImRpc2FibGVkXCIpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbSh0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKHRoaXMuX2lucHV0U2VsZWN0b3IpKTtcbiAgICAgICAgY29uc3QgYnV0dG9uRWxlbWVudCA9IHRoaXMuX2Zvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuXG4gICAgICAgIGlucHV0TGlzdC5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgICAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgICAgICBjb25zdCBzdWJtaXRGb3JtSGFuZGxlciA9IChldmVudCkgPT4ge1xuICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5fZm9ybUVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCBzdWJtaXRGb3JtSGFuZGxlcik7XG5cbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB9O1xufSIsImV4cG9ydCBjbGFzcyBTZWN0aW9uIHtcbiAgICBjb25zdHJ1Y3Rvcih7IGl0ZW1zLCByZW5kZXJlciB9LCBjb250YWluZXJTZWxlY3Rvcikge1xuICAgICAgICB0aGlzLl9yZW5kZXJlZEl0ZW1zID0gaXRlbXM7XG4gICAgICAgIHRoaXMuX3JlbmRlcmVyID0gcmVuZGVyZXI7XG5cbiAgICAgICAgdGhpcy5fY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihjb250YWluZXJTZWxlY3Rvcik7XG4gICAgfVxuXG4gICAgcmVuZGVySXRlbXMoKSB7XG4gICAgICAgIHRoaXMuX3JlbmRlcmVkSXRlbXMuZm9yRWFjaChpdGVtID0+IHRoaXMuX3JlbmRlcmVyKGl0ZW0pKTtcbiAgICB9XG5cbiAgICBhZGRJdGVtKGVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5fY29udGFpbmVyLnByZXBlbmQoZWxlbWVudCk7XG4gICAgfVxufVxuXG4iLCJcbmV4cG9ydCBjbGFzcyBQb3B1cCB7XG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgICAgICB0aGlzLl9wb3B1cCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX2hhbmRsZUVzY0Nsb3NlID0gdGhpcy5faGFuZGxlRXNjQ2xvc2UuYmluZCh0aGlzKTtcbiAgICB9XG5cbiAgICBvcGVuKCkge1xuICAgICAgICB0aGlzLl9wb3B1cC5jbGFzc0xpc3QuYWRkKCdwb3B1cF9vcGVuZWQnKTtcbiAgICAgICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5ZG93bicsIHRoaXMuX2hhbmRsZUVzY0Nsb3NlKTtcbiAgICB9XG5cbiAgICBjbG9zZSgpIHtcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LnJlbW92ZSgncG9wdXBfb3BlbmVkJyk7XG4gICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7IFxuICAgIH1cblxuICAgIF9oYW5kbGVFc2NDbG9zZSgpIHtcbiAgICAgICAgaWYgKHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5jb250YWlucygncG9wdXBfb3BlbmVkJykpIHtcbiAgICAgICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZXZ0KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGV2dC5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCAoZXZ0KSA9PiB7XG4gICAgICAgICAgICAgICAgaWYgKGV2dC5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNldEV2ZW50TGlzdGVuZXJzKHBvcHVwKSB7XG4gICAgICAgIGNvbnN0IHBvcHVwQ2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2Nsb3NlJyk7XG4gICAgICAgIHBvcHVwQ2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLmNsb3NlKCkpO1xuXG5cbiAgICAgICAgdGhpcy5fcG9wdXAuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoZXZ0KSA9PiB7XG4gICAgICAgICAgICBpZiAoZXZ0LnRhcmdldCAhPT0gZXZ0LmN1cnJlbnRUYXJnZXQpIHtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuY2xvc2UoZXZ0LmN1cnJlbnRUYXJnZXQpO1xuICAgICAgICB9KTtcbiAgICB9XG59XG4iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gJy4vUG9wdXAuanMnO1xuXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoSW1hZ2UgZXh0ZW5kcyBQb3B1cCB7XG4gICAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICB9XG5cbiAgICBvcGVuKG5hbWUsIGxpbmspIHtcbiAgICAgICAgdGhpcy5fcG9wdXBJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW1hZ2UnKTtcbiAgICAgICAgdGhpcy5fcG9wdXBUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fY2FwdGlvbicpO1xuICAgICAgICB0aGlzLl9wb3B1cEltYWdlLnNyYyA9IGxpbms7XG4gICAgICAgIHRoaXMuX3BvcHVwVGl0bGUudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgICAgICBzdXBlci5vcGVuKCk7XG4gICAgfVxufSIsImltcG9ydCB7IFBvcHVwIH0gZnJvbSAnLi9Qb3B1cC5qcyc7XG5cbmV4cG9ydCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHsgcG9wdXBTZWxlY3RvciwgaGFuZGxlRm9ybVN1Ym1pdCB9KSB7XG4gICAgICAgIHN1cGVyKHBvcHVwU2VsZWN0b3IpO1xuICAgICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0ID0gaGFuZGxlRm9ybVN1Ym1pdDtcbiAgICB9XG5cbiAgICBfZ2V0SW5wdXRWYWx1ZXMoKSB7XG4gICAgICAgIGNvbnN0IHVzZXJJbnB1dHMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXBfX2ZpZWxkJyk7XG4gICAgICAgIHRoaXMuX2lucHV0VmFsdWVzID0ge307XG4gICAgICAgIHVzZXJJbnB1dHMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5faW5wdXRWYWx1ZXNbaXRlbS5uYW1lXSA9IGl0ZW0udmFsdWU7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gdGhpcy5faW5wdXRWYWx1ZXM7XG4gICAgfVxuXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHN1cGVyLmNsb3NlKCk7XG4gICAgICAgIHRoaXMuX3BvcHVwLnF1ZXJ5U2VsZWN0b3IoJ2Zvcm0nKS5yZXNldCgpOyBcbiAgICB9XG5cbiAgICBzZXRFdmVudExpc3RlbmVycyhwb3B1cCkge1xuICAgICAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycyhwb3B1cCk7XG4gICAgICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoJ3N1Ym1pdCcsIChldnQpID0+IHtcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICAgICAgfSlcbiAgICB9XG59XG5cblxuIiwiZXhwb3J0IGNsYXNzIFVzZXJJbmZvIHtcbiAgICBjb25zdHJ1Y3RvcigpIHtcbiAgICAgICAgdGhpcy50aXRsZVNlbGVjdG9yID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX3RpdGxlJyk7XG4gICAgICAgIHRoaXMuc3VidGl0bGVTZWxlY3RvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19zdWJ0aXRsZScpO1xuICAgIH1cblxuICAgIGdldFVzZXJJbmZvKCkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbmFtZTogdGhpcy50aXRsZVNlbGVjdG9yLnRleHRDb250ZW50LFxuICAgICAgICAgICAgam9iSW5wdXQ6IHRoaXMuc3VidGl0bGVTZWxlY3Rvci50ZXh0Q29udGVudFxuICAgICAgICB9XG4gICAgfVxuXG4gICAgc2V0VXNlckluZm8oeyBuYW1lLCBqb2IgfSkge1xuICAgICAgICB0aGlzLnRpdGxlU2VsZWN0b3IudGV4dENvbnRlbnQgPSBuYW1lO1xuICAgICAgICB0aGlzLnN1YnRpdGxlU2VsZWN0b3IudGV4dENvbnRlbnQgPSBqb2I7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgQ2FyZCB9IGZyb20gJy4uL2NvbXBvbmVudHMvQ2FyZC5qcyc7XG5pbXBvcnQgeyBpbml0aWFsQ2FyZHMsIHBhcmFtcywgcG9wdXBBZGQsIGFkZENhcmRCdXR0b24sIHByb2ZpbGVFZGl0QnV0dG9uIH0gZnJvbSAnLi4vdXRpbHMvY29uc3RhbnQuanMnO1xuaW1wb3J0IHsgRm9ybVZhbGlkYXRvciB9IGZyb20gJy4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyc7XG5pbXBvcnQgeyBTZWN0aW9uIH0gZnJvbSAnLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzJztcbmltcG9ydCB7IFBvcHVwV2l0aEltYWdlIH0gZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyc7XG5pbXBvcnQgeyBQb3B1cFdpdGhGb3JtIH0gZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzJztcbmltcG9ydCB7IFVzZXJJbmZvIH0gZnJvbSAnLi4vY29tcG9uZW50cy9Vc2VySW5mby5qcyc7XG5pbXBvcnQgJy4vaW5kZXguY3NzJztcblxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oKTtcblxuY29uc3QgZ2VuZXJhdGVDYXJkVGVtcGxhdGUgPSAoKSA9PiBkb2N1bWVudFxuICAgIC5xdWVyeVNlbGVjdG9yKFwiI2VsZW1lbnRzXCIpXG4gICAgLmNvbnRlbnRcbiAgICAucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX2NhcmRzJylcbiAgICAuY2xvbmVOb2RlKHRydWUpO1xuXG5jb25zdCBwb3B1cEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKCcucG9wdXBfdHlwZV9pbWcnKTtcbnBvcHVwSW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgaGFuZGxlQ2FyZENsaWNrID0gKHsgbmFtZSwgbGluayB9KSA9PiB7XG4gICAgcG9wdXBJbWFnZS5vcGVuKG5hbWUsIGxpbmspO1xufTtcblxuY29uc3QgZ2V0Q2FyZEVsZW1lbnQgPSAoeyBuYW1lLCBsaW5rIH0pID0+IHtcbiAgICBjb25zdCBjYXJkID0gbmV3IENhcmQobmFtZSwgbGluaywgZ2VuZXJhdGVDYXJkVGVtcGxhdGUoKSwgaGFuZGxlQ2FyZENsaWNrKTtcbiAgICByZXR1cm4gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcbn1cblxuY29uc3QgY2FyZHNMaXN0ID0gbmV3IFNlY3Rpb24oe1xuICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXG4gICAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XG4gICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoe25hbWU6IGl0ZW0ubmFtZSwgbGluazogaXRlbS5saW5rfSk7XG4gICAgICAgIGNhcmRzTGlzdC5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbiAgICB9XG59LFxuICAgICcuZWxlbWVudCdcbik7XG5cbmNhcmRzTGlzdC5yZW5kZXJJdGVtcygpO1xuXG5jb25zdCBmb3JtQWRkID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xuICAgIHBvcHVwU2VsZWN0b3I6ICcucG9wdXBfdHlwZV9hZGQnLFxuICAgIGhhbmRsZUZvcm1TdWJtaXQ6IChpbnB1dFZhbHVlcykgPT4ge1xuICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KHsgbmFtZTogaW5wdXRWYWx1ZXMudGl0bGUsIGxpbms6IGlucHV0VmFsdWVzLnBpY3R1cmUgfSk7XG4gICAgICAgIGNhcmRzTGlzdC5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbiAgICAgICAgZm9ybUFkZC5jbG9zZSgpO1xuICAgIH1cbn0pO1xuXG5mb3JtQWRkLnNldEV2ZW50TGlzdGVuZXJzKGZvcm1FZGl0KTtcblxuYWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBmb3JtQWRkLm9wZW4oKTtcblxuICAgIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20ocG9wdXBBZGQucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwX19maWVsZCcpKTtcbiAgICBjb25zdCBidXR0b25FbGVtZW50ID0gcG9wdXBBZGQucXVlcnlTZWxlY3RvcignLnBvcHVwX19zdWJtaXQtYnV0dG9uJyk7XG5cbiAgICBmb3JtQWRkVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCk7XG59KTtcblxuY29uc3QgZm9ybUVkaXQgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gICAgcG9wdXBTZWxlY3RvcjogJy5wb3B1cF90eXBlX2VkaXQnLFxuICAgIGhhbmRsZUZvcm1TdWJtaXQ6IChpbnB1dHNWYWx1ZXMpID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oeyBuYW1lOiBpbnB1dHNWYWx1ZXMuZnVsbG5hbWUsIGpvYjogaW5wdXRzVmFsdWVzLmpvYiB9KTtcbiAgICAgICAgZm9ybUVkaXQuY2xvc2UoKTtcbiAgICB9XG5cbn0pO1xuXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBjb25zdCBwcm9maWxlID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgICBjb25zdCBpbnB1dHNOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19maWVsZF9pbnB1dF9uYW1lJyk7XG4gICAgY29uc3QgaW5wdXRzSm9iID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19maWVsZF9pbnB1dF9qb2InKTtcblxuICAgIGlucHV0c05hbWUudmFsdWUgPSBwcm9maWxlLm5hbWU7XG4gICAgaW5wdXRzSm9iLnZhbHVlID0gcHJvZmlsZS5qb2JJbnB1dDtcblxuICAgIGZvcm1FZGl0Lm9wZW4oKTtcbn0pO1xuXG5mb3JtRWRpdC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBmb3JtQWRkVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IocGFyYW1zLCBwYXJhbXMuZm9ybUFkZCk7XG5mb3JtQWRkVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgZm9ybUVkaXRWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihwYXJhbXMsIHBhcmFtcy5mb3JtRWRpdCk7XG5mb3JtRWRpdFZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cblxuIl0sInNvdXJjZVJvb3QiOiIifQ==