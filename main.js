(()=>{"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var t=function(){function t(e,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=e,this._link=n,this._template=r,this._handleCardClick=o}var n,r;return n=t,(r=[{key:"generateCard",value:function(){return this._element=this._template,this._image=this._element.querySelector(".element__image"),this._image.src=this._link,this._image.alt=this._name,this._element.querySelector(".element__title").textContent=this._name,this._setEventListeners(),this._element}},{key:"_handleDeleteCard",value:function(){this._element.remove()}},{key:"_setEventListeners",value:function(){var e=this;this._element.querySelector(".element__delete-button").addEventListener("click",(function(){e._handleDeleteCard()})),this._element.querySelector(".element__like-image").addEventListener("click",(function(e){e.target.classList.toggle("element__like-image-active")})),this._image.addEventListener("click",(function(){return e._handleCardClick({name:e._name,link:e._link})}))}}])&&e(n.prototype,r),t}(),n={formSelector:".popup__form",inputSelector:".popup__field",formAdd:".popup_type_add",formEdit:".popup_type_edit",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button-disabled",inputErrorClass:"popup__field-error",errorClass:"popup__field-error-active"},r=(document.querySelector(".popup__image"),document.querySelector(".popup__caption"),document.querySelector(".popup_type_add")),o=document.querySelector(".profile__edit-button"),i=document.querySelector(".profile__add-button");function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var c=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._formElement=document.querySelector(n),this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass}var t,n;return t=e,(n=[{key:"_showInputError",value:function(e,t){var n=this._formElement.querySelector("#".concat(e.id,"-error"));n.classList.add(this._errorClass),n.textContent=t}},{key:"_hideInputError",value:function(e){var t=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.remove(this._errorClass),t.textContent=""}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_hasInvalidInput",value:function(e){return e.some((function(e){return!e.validity.valid}))}},{key:"toggleButtonState",value:function(e,t){this._hasInvalidInput(e)?(t.classList.add(this._inactiveButtonClass),t.setAttribute("disabled",!0)):(t.classList.remove(this._inactiveButtonClass),t.removeAttribute("disabled"))}},{key:"_setEventListeners",value:function(){var e=this,t=Array.from(this._formElement.querySelectorAll(this._inputSelector)),n=this._formElement.querySelector(this._submitButtonSelector);t.forEach((function(r){r.addEventListener("input",(function(){e._checkInputValidity(r),e.toggleButtonState(t,n)}))}))}},{key:"enableValidation",value:function(){this._formElement.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}}])&&u(t.prototype,n),e}();function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(t,n){var r=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._renderedItems=r,this._renderer=o,this._container=document.querySelector(n)}var t,n;return t=e,(n=[{key:"renderItems",value:function(){var e=this;this._renderedItems.forEach((function(t){return e._renderer(t)}))}},{key:"addItem",value:function(e){this._container.prepend(e)}}])&&a(t.prototype,n),e}();function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popup=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}var t,n;return t=e,(n=[{key:"open",value:function(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"_handleEscClose",value:function(){var e=this;this._popup.classList.contains("popup_opened")?document.addEventListener("keydown",(function(t){"Escape"===t.key&&e.close()})):document.removeEventListener("keydown",(function(t){"Escape"===t.key&&e.close()}))}},{key:"setEventListeners",value:function(e){var t=this;this._popup.querySelector(".popup__close").addEventListener("click",(function(){return t.close()})),this._popup.addEventListener("click",(function(e){e.target===e.currentTarget&&t.close(e.currentTarget)}))}}])&&s(t.prototype,n),e}();function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function y(e,t,n){return(y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=h(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function _(e,t){return(_=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var v=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=h(r);if(o){var n=h(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return m(this,e)});function u(e){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),i.call(this,e)}return t=u,(n=[{key:"open",value:function(e,t){this._popupImage=document.querySelector(".popup__image"),this._popupTitle=document.querySelector(".popup__caption"),this._popupImage.src=t,this._popupTitle.textContent=e,y(h(u.prototype),"open",this).call(this)}}])&&d(t.prototype,n),u}(p);function b(e){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function g(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function S(e,t,n){return(S="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=w(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function k(e,t){return(k=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function E(e,t){return!t||"object"!==b(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var C=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&k(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=w(r);if(o){var n=w(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return E(this,e)});function u(e){var t,n=e.popupSelector,r=e.handleFormSubmit;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=i.call(this,n))._handleFormSubmit=r,t}return t=u,(n=[{key:"_getInputValues",value:function(){var e=this,t=document.querySelectorAll(".popup__field");return this._inputValues={},t.forEach((function(t){e._inputValues[t.name]=t.value})),this._inputValues}},{key:"close",value:function(){S(w(u.prototype),"close",this).call(this),this._popup.querySelector("form").reset()}},{key:"setEventListeners",value:function(e){var t=this;S(w(u.prototype),"setEventListeners",this).call(this,e),this._popup.addEventListener("submit",(function(e){e.preventDefault(),t._handleFormSubmit(t._getInputValues())}))}}])&&g(t.prototype,n),u}(p);function j(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var O=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.titleSelector=document.querySelector(".profile__title"),this.subtitleSelector=document.querySelector(".profile__subtitle")}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{name:this.titleSelector.textContent,jobInput:this.subtitleSelector.textContent}}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.job;this.titleSelector.textContent=t,this.subtitleSelector.textContent=n}}])&&j(t.prototype,n),e}()),L=new v(".popup_type_img");L.setEventListeners();var q=function(e){var t=e.name,n=e.link;L.open(t,n)},I=new l({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:function(e){var n=new t(e.name,e.link,document.querySelector("#elements").content.querySelector(".element__cards").cloneNode(!0),q).generateCard();I.addItem(n)}},".element");I.renderItems();var P=new C({popupSelector:".popup_type_add",handleFormSubmit:function(e){I.addItem({name:e.title,link:e.picture}),P.close()}});P.setEventListeners(x),i.addEventListener("click",(function(){P.open();var e=Array.from(r.querySelectorAll(".popup__field")),t=r.querySelector(".popup__submit-button");R.toggleButtonState(e,t)}));var x=new C({popupSelector:".popup_type_edit",handleFormSubmit:function(e){O.setUserInfo({name:e.fullname,job:e.job}),x.close()}});o.addEventListener("click",(function(){var e=O.getUserInfo(),t=document.querySelector(".popup__field_input_name"),n=document.querySelector(".popup__field_input_job");t.value=e.name,n.value=e.jobInput,x.open()})),x.setEventListeners();var R=new c(n,n.formAdd);R.enableValidation(),new c(n,n.formEdit).enableValidation()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvdXRpbHMvY29uc3RhbnQuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvcGFnZXMvaW5kZXguanMiXSwibmFtZXMiOlsiQ2FyZCIsIm5hbWUiLCJsaW5rIiwidGVtcGxhdGUiLCJoYW5kbGVDYXJkQ2xpY2siLCJ0aGlzIiwiX25hbWUiLCJfbGluayIsIl90ZW1wbGF0ZSIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfZWxlbWVudCIsIl9pbWFnZSIsInF1ZXJ5U2VsZWN0b3IiLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsIl9zZXRFdmVudExpc3RlbmVycyIsInJlbW92ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlRGVsZXRlQ2FyZCIsImV2ZW50IiwidGFyZ2V0IiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwicGFyYW1zIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsImZvcm1BZGQiLCJmb3JtRWRpdCIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJwb3B1cEFkZCIsImRvY3VtZW50IiwicHJvZmlsZUVkaXRCdXR0b24iLCJhZGRDYXJkQnV0dG9uIiwiRm9ybVZhbGlkYXRvciIsImZvcm1FbGVtZW50IiwiX2Zvcm1FbGVtZW50IiwiX2lucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImlucHV0RWxlbWVudCIsImVycm9yTWVzc2FnZSIsImVycm9yRWxlbWVudCIsImlkIiwiYWRkIiwidmFsaWRpdHkiLCJ2YWxpZCIsIl9oaWRlSW5wdXRFcnJvciIsIl9zaG93SW5wdXRFcnJvciIsInZhbGlkYXRpb25NZXNzYWdlIiwiaW5wdXRMaXN0Iiwic29tZSIsImJ1dHRvbkVsZW1lbnQiLCJfaGFzSW52YWxpZElucHV0Iiwic2V0QXR0cmlidXRlIiwicmVtb3ZlQXR0cmlidXRlIiwiQXJyYXkiLCJmcm9tIiwicXVlcnlTZWxlY3RvckFsbCIsImZvckVhY2giLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidG9nZ2xlQnV0dG9uU3RhdGUiLCJwcmV2ZW50RGVmYXVsdCIsIlNlY3Rpb24iLCJjb250YWluZXJTZWxlY3RvciIsIml0ZW1zIiwicmVuZGVyZXIiLCJfcmVuZGVyZWRJdGVtcyIsIl9yZW5kZXJlciIsIl9jb250YWluZXIiLCJpdGVtIiwiZWxlbWVudCIsInByZXBlbmQiLCJQb3B1cCIsInBvcHVwU2VsZWN0b3IiLCJfcG9wdXAiLCJfaGFuZGxlRXNjQ2xvc2UiLCJiaW5kIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImNvbnRhaW5zIiwiZXZ0Iiwia2V5IiwiY2xvc2UiLCJwb3B1cCIsImN1cnJlbnRUYXJnZXQiLCJQb3B1cFdpdGhJbWFnZSIsIl9wb3B1cEltYWdlIiwiX3BvcHVwVGl0bGUiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsIl9oYW5kbGVGb3JtU3VibWl0IiwidXNlcklucHV0cyIsIl9pbnB1dFZhbHVlcyIsInZhbHVlIiwicmVzZXQiLCJfZ2V0SW5wdXRWYWx1ZXMiLCJ1c2VySW5mbyIsInRpdGxlU2VsZWN0b3IiLCJzdWJ0aXRsZVNlbGVjdG9yIiwiam9iSW5wdXQiLCJqb2IiLCJwb3B1cEltYWdlIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJvcGVuIiwiY2FyZHNMaXN0IiwiY2FyZEVsZW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiZ2VuZXJhdGVDYXJkIiwiYWRkSXRlbSIsInJlbmRlckl0ZW1zIiwiaW5wdXRWYWx1ZXMiLCJ0aXRsZSIsInBpY3R1cmUiLCJmb3JtQWRkVmFsaWRhdG9yIiwiaW5wdXRzVmFsdWVzIiwic2V0VXNlckluZm8iLCJmdWxsbmFtZSIsInByb2ZpbGUiLCJnZXRVc2VySW5mbyIsImlucHV0c05hbWUiLCJpbnB1dHNKb2IiLCJlbmFibGVWYWxpZGF0aW9uIl0sIm1hcHBpbmdzIjoieUxBQU8sSUFBTUEsRUFBYixXQUNJLFdBQVlDLEVBQU1DLEVBQU1DLEVBQVVDLEksNEZBQWlCLFNBQy9DQyxLQUFLQyxNQUFRTCxFQUNiSSxLQUFLRSxNQUFRTCxFQUNiRyxLQUFLRyxVQUFZTCxFQUNqQkUsS0FBS0ksaUJBQW1CTCxFLFFBTGhDLE8sRUFBQSxHLEVBQUEsc0NBaUJRLE9BUkFDLEtBQUtLLFNBQVdMLEtBQUtHLFVBQ3JCSCxLQUFLTSxPQUFTTixLQUFLSyxTQUFTRSxjQUFjLG1CQUMxQ1AsS0FBS00sT0FBT0UsSUFBTVIsS0FBS0UsTUFDdkJGLEtBQUtNLE9BQU9HLElBQU1ULEtBQUtDLE1BQ3ZCRCxLQUFLSyxTQUFTRSxjQUFjLG1CQUFtQkcsWUFBY1YsS0FBS0MsTUFFbEVELEtBQUtXLHFCQUVFWCxLQUFLSyxXQWpCcEIsMENBcUJRTCxLQUFLSyxTQUFTTyxXQXJCdEIsMkNBd0J5QixXQUNqQlosS0FBS0ssU0FDQUUsY0FBYywyQkFDZE0saUJBQWlCLFNBQVMsV0FDdkIsRUFBS0MsdUJBR2JkLEtBQUtLLFNBQ0FFLGNBQWMsd0JBQ2RNLGlCQUFpQixTQUFTLFNBQUFFLEdBQ3ZCQSxFQUFNQyxPQUFPQyxVQUFVQyxPQUFPLGlDQUd0Q2xCLEtB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QVk1RixTQUFTdEIsY0FBYywyQkFFekNpSCxFQUFXM0IsTUFBUXlCLEVBQVExSCxLQUMzQjZILEVBQVU1QixNQUFReUIsRUFBUW5CLFNBRTFCNUUsRUFBU2dGLFVBR2JoRixFQUFTK0Usb0JBRVQsSUFBTVksRUFBbUIsSUFBSWxGLEVBQWNiLEVBQVFBLEVBQU9HLFNBQzFENEYsRUFBaUJRLG1CQUVTLElBQUkxRixFQUFjYixFQUFRQSxFQUFPSSxVQUN6Q21HLG9CIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY2xhc3MgQ2FyZCB7XG4gICAgY29uc3RydWN0b3IobmFtZSwgbGluaywgdGVtcGxhdGUsIGhhbmRsZUNhcmRDbGljaykge1xuICAgICAgICB0aGlzLl9uYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy5fbGluayA9IGxpbms7XG4gICAgICAgIHRoaXMuX3RlbXBsYXRlID0gdGVtcGxhdGU7XG4gICAgICAgIHRoaXMuX2hhbmRsZUNhcmRDbGljayA9IGhhbmRsZUNhcmRDbGljaztcbiAgICB9XG5cbiAgICBnZW5lcmF0ZUNhcmQoKSB7XG4gICAgICAgIHRoaXMuX2VsZW1lbnQgPSB0aGlzLl90ZW1wbGF0ZTtcbiAgICAgICAgdGhpcy5faW1hZ2UgPSB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19pbWFnZScpO1xuICAgICAgICB0aGlzLl9pbWFnZS5zcmMgPSB0aGlzLl9saW5rO1xuICAgICAgICB0aGlzLl9pbWFnZS5hbHQgPSB0aGlzLl9uYW1lO1xuICAgICAgICB0aGlzLl9lbGVtZW50LnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X190aXRsZScpLnRleHRDb250ZW50ID0gdGhpcy5fbmFtZTtcblxuICAgICAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuXG4gICAgICAgIHJldHVybiB0aGlzLl9lbGVtZW50O1xuICAgIH1cblxuICAgIF9oYW5kbGVEZWxldGVDYXJkKCkge1xuICAgICAgICB0aGlzLl9lbGVtZW50LnJlbW92ZSgpO1xuICAgIH1cblxuICAgIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAgICAgdGhpcy5fZWxlbWVudFxuICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19kZWxldGUtYnV0dG9uJylcbiAgICAgICAgICAgIC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLl9oYW5kbGVEZWxldGVDYXJkKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB0aGlzLl9lbGVtZW50XG4gICAgICAgICAgICAucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX2xpa2UtaW1hZ2UnKVxuICAgICAgICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgZXZlbnQgPT4ge1xuICAgICAgICAgICAgICAgIGV2ZW50LnRhcmdldC5jbGFzc0xpc3QudG9nZ2xlKCdlbGVtZW50X19saWtlLWltYWdlLWFjdGl2ZScpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5faW1hZ2VcbiAgICAgICAgICAgIC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHRoaXMuX2hhbmRsZUNhcmRDbGljayh7IG5hbWU6IHRoaXMuX25hbWUsIGxpbms6IHRoaXMuX2xpbmt9KSk7XG4gICAgfVxufSAiLCJleHBvcnQgY29uc3QgaW5pdGlhbENhcmRzID0gW1xuICAgIHtcbiAgICAgICAgbmFtZTogJ9CQ0YDRhdGL0LcnLFxuICAgICAgICBsaW5rOiAnaHR0cHM6Ly9waWN0dXJlcy5zMy55YW5kZXgubmV0L2Zyb250ZW5kLWRldmVsb3Blci9jYXJkcy1jb21wcmVzc2VkL2Fya2h5ei5qcGcnXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6ICfQp9C10LvRj9Cx0LjQvdGB0LrQsNGPINC+0LHQu9Cw0YHRgtGMJyxcbiAgICAgICAgbGluazogJ2h0dHBzOi8vcGljdHVyZXMuczMueWFuZGV4Lm5ldC9mcm9udGVuZC1kZXZlbG9wZXIvY2FyZHMtY29tcHJlc3NlZC9jaGVseWFiaW5zay1vYmxhc3QuanBnJ1xuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiAn0JjQstCw0L3QvtCy0L4nLFxuICAgICAgICBsaW5rOiAnaHR0cHM6Ly9waWN0dXJlcy5zMy55YW5kZXgubmV0L2Zyb250ZW5kLWRldmVsb3Blci9jYXJkcy1jb21wcmVzc2VkL2l2YW5vdm8uanBnJ1xuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiAn0JrQsNC80YfQsNGC0LrQsCcsXG4gICAgICAgIGxpbms6ICdodHRwczovL3BpY3R1cmVzLnMzLnlhbmRleC5uZXQvZnJvbnRlbmQtZGV2ZWxvcGVyL2NhcmRzLWNvbXByZXNzZWQva2FtY2hhdGthLmpwZydcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogJ9Cl0L7Qu9C80L7Qs9C+0YDRgdC60LjQuSDRgNCw0LnQvtC9JyxcbiAgICAgICAgbGluazogJ2h0dHBzOi8vcGljdHVyZXMuczMueWFuZGV4Lm5ldC9mcm9udGVuZC1kZXZlbG9wZXIvY2FyZHMtY29tcHJlc3NlZC9raG9sbW9nb3Jza3ktcmF5b24uanBnJ1xuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiAn0JHQsNC50LrQsNC7JyxcbiAgICAgICAgbGluazogJ2h0dHBzOi8vcGljdHVyZXMuczMueWFuZGV4Lm5ldC9mcm9udGVuZC1kZXZlbG9wZXIvY2FyZHMtY29tcHJlc3NlZC9iYWlrYWwuanBnJ1xuICAgIH1cbl07XG5cbmV4cG9ydCBjb25zdCBwYXJhbXMgPSB7XG4gICAgZm9ybVNlbGVjdG9yOiAnLnBvcHVwX19mb3JtJyxcbiAgICBpbnB1dFNlbGVjdG9yOiAnLnBvcHVwX19maWVsZCcsXG4gICAgZm9ybUFkZDogJy5wb3B1cF90eXBlX2FkZCcsXG4gICAgZm9ybUVkaXQ6ICcucG9wdXBfdHlwZV9lZGl0JyxcbiAgICBzdWJtaXRCdXR0b25TZWxlY3RvcjogJy5wb3B1cF9fc3VibWl0LWJ1dHRvbicsXG4gICAgaW5hY3RpdmVCdXR0b25DbGFzczogJ3BvcHVwX19zdWJtaXQtYnV0dG9uLWRpc2FibGVkJyxcbiAgICBpbnB1dEVycm9yQ2xhc3M6ICdwb3B1cF9fZmllbGQtZXJyb3InLFxuICAgIGVycm9yQ2xhc3M6ICdwb3B1cF9fZmllbGQtZXJyb3ItYWN0aXZlJ1xufVxuXG5leHBvcnQgY29uc3QgcG9wdXBJbWFnZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9faW1hZ2UnKTtcbmV4cG9ydCBjb25zdCBwb3B1cFRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19jYXB0aW9uJyk7XG5cbmV4cG9ydCBjb25zdCBwb3B1cEFkZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF90eXBlX2FkZCcpO1xuXG5leHBvcnQgY29uc3QgcHJvZmlsZUVkaXRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fZWRpdC1idXR0b24nKTtcbmV4cG9ydCBjb25zdCBhZGRDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2FkZC1idXR0b24nKTsiLCJleHBvcnQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gICAgY29uc3RydWN0b3IocGFyYW1zLCBmb3JtRWxlbWVudCkge1xuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZm9ybUVsZW1lbnQpO1xuICAgICAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gcGFyYW1zLmlucHV0U2VsZWN0b3I7XG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gcGFyYW1zLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgICAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gcGFyYW1zLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHBhcmFtcy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBwYXJhbXMuZXJyb3JDbGFzcztcbiAgICB9XG5cbiAgICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpIHtcbiAgICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuXG4gICAgICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG4gICAgfTtcblxuICAgIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuXG4gICAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSAnJztcbiAgICB9O1xuXG4gICAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcbiAgICAgICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgICAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgX2hhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpIHtcbiAgICAgICAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+ICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpO1xuICAgIH07XG5cbiAgICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQpIHtcbiAgICAgICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XG4gICAgICAgICAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICAgICAgICBidXR0b25FbGVtZW50LnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIHRydWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgICAgICAgYnV0dG9uRWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20odGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKSk7XG4gICAgICAgIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcblxuICAgICAgICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICAgICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICAgICAgY29uc3Qgc3VibWl0Rm9ybUhhbmRsZXIgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgc3VibWl0Rm9ybUhhbmRsZXIpO1xuXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgfTtcbn0iLCJleHBvcnQgY2xhc3MgU2VjdGlvbiB7XG4gICAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICAgICAgdGhpcy5fcmVuZGVyZWRJdGVtcyA9IGl0ZW1zO1xuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICAgIH1cblxuICAgIHJlbmRlckl0ZW1zKCkge1xuICAgICAgICB0aGlzLl9yZW5kZXJlZEl0ZW1zLmZvckVhY2goaXRlbSA9PiB0aGlzLl9yZW5kZXJlcihpdGVtKSk7XG4gICAgfVxuXG4gICAgYWRkSXRlbShlbGVtZW50KSB7XG4gICAgICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICAgIH1cbn1cblxuIiwiXG5leHBvcnQgY2xhc3MgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICAgICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgICAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XG4gICAgfVxuXG4gICAgb3BlbigpIHtcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZCgncG9wdXBfb3BlbmVkJyk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgfVxuXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX29wZW5lZCcpO1xuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpOyBcbiAgICB9XG5cbiAgICBfaGFuZGxlRXNjQ2xvc2UoKSB7XG4gICAgICAgIGlmICh0aGlzLl9wb3B1cC5jbGFzc0xpc3QuY29udGFpbnMoJ3BvcHVwX29wZW5lZCcpKSB7XG4gICAgICAgICAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGV2dCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChldnQua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgKGV2dCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChldnQua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzZXRFdmVudExpc3RlbmVycyhwb3B1cCkge1xuICAgICAgICBjb25zdCBwb3B1cENsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19jbG9zZScpO1xuICAgICAgICBwb3B1cENsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5jbG9zZSgpKTtcblxuXG4gICAgICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2dCkgPT4ge1xuICAgICAgICAgICAgaWYgKGV2dC50YXJnZXQgIT09IGV2dC5jdXJyZW50VGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmNsb3NlKGV2dC5jdXJyZW50VGFyZ2V0KTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tICcuL1BvcHVwLmpzJztcblxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICAgICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgfVxuXG4gICAgb3BlbihuYW1lLCBsaW5rKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltYWdlJyk7XG4gICAgICAgIHRoaXMuX3BvcHVwVGl0bGUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2NhcHRpb24nKTtcbiAgICAgICAgdGhpcy5fcG9wdXBJbWFnZS5zcmMgPSBsaW5rO1xuICAgICAgICB0aGlzLl9wb3B1cFRpdGxlLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICAgICAgc3VwZXIub3BlbigpO1xuICAgIH1cbn0iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gJy4vUG9wdXAuanMnO1xuXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQgfSkge1xuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgfVxuXG4gICAgX2dldElucHV0VmFsdWVzKCkge1xuICAgICAgICBjb25zdCB1c2VySW5wdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwX19maWVsZCcpO1xuICAgICAgICB0aGlzLl9pbnB1dFZhbHVlcyA9IHt9O1xuICAgICAgICB1c2VySW5wdXRzLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2lucHV0VmFsdWVzW2l0ZW0ubmFtZV0gPSBpdGVtLnZhbHVlO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lucHV0VmFsdWVzO1xuICAgIH1cblxuICAgIGNsb3NlKCkge1xuICAgICAgICBzdXBlci5jbG9zZSgpO1xuICAgICAgICB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCdmb3JtJykucmVzZXQoKTsgXG4gICAgfVxuXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMocG9wdXApIHtcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMocG9wdXApO1xuICAgICAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZ0KSA9PiB7XG4gICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgICAgIH0pXG4gICAgfVxufVxuXG5cbiIsImV4cG9ydCBjbGFzcyBVc2VySW5mbyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMudGl0bGVTZWxlY3RvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX190aXRsZScpO1xuICAgICAgICB0aGlzLnN1YnRpdGxlU2VsZWN0b3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fc3VidGl0bGUnKTtcbiAgICB9XG5cbiAgICBnZXRVc2VySW5mbygpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG5hbWU6IHRoaXMudGl0bGVTZWxlY3Rvci50ZXh0Q29udGVudCxcbiAgICAgICAgICAgIGpvYklucHV0OiB0aGlzLnN1YnRpdGxlU2VsZWN0b3IudGV4dENvbnRlbnRcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNldFVzZXJJbmZvKHsgbmFtZSwgam9iIH0pIHtcbiAgICAgICAgdGhpcy50aXRsZVNlbGVjdG9yLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICAgICAgdGhpcy5zdWJ0aXRsZVNlbGVjdG9yLnRleHRDb250ZW50ID0gam9iO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IENhcmQgfSBmcm9tICcuLi9jb21wb25lbnRzL0NhcmQuanMnO1xuaW1wb3J0IHsgaW5pdGlhbENhcmRzLCBwYXJhbXMsIHBvcHVwQWRkLCBhZGRDYXJkQnV0dG9uLCBwcm9maWxlRWRpdEJ1dHRvbiB9IGZyb20gJy4uL3V0aWxzL2NvbnN0YW50LmpzJztcbmltcG9ydCB7IEZvcm1WYWxpZGF0b3IgfSBmcm9tICcuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMnO1xuaW1wb3J0IHsgU2VjdGlvbiB9IGZyb20gJy4uL2NvbXBvbmVudHMvU2VjdGlvbi5qcyc7XG5pbXBvcnQgeyBQb3B1cFdpdGhJbWFnZSB9IGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMnO1xuaW1wb3J0IHsgUG9wdXBXaXRoRm9ybSB9IGZyb20gJy4uL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyc7XG5pbXBvcnQgeyBVc2VySW5mbyB9IGZyb20gJy4uL2NvbXBvbmVudHMvVXNlckluZm8uanMnO1xuaW1wb3J0ICcuL2luZGV4LmNzcyc7XG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKCk7XG5cbmNvbnN0IGdlbmVyYXRlQ2FyZFRlbXBsYXRlID0gKCkgPT4gZG9jdW1lbnRcbiAgICAucXVlcnlTZWxlY3RvcihcIiNlbGVtZW50c1wiKVxuICAgIC5jb250ZW50XG4gICAgLnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19jYXJkcycpXG4gICAgLmNsb25lTm9kZSh0cnVlKTtcblxuY29uc3QgcG9wdXBJbWFnZSA9IG5ldyBQb3B1cFdpdGhJbWFnZSgnLnBvcHVwX3R5cGVfaW1nJyk7XG5wb3B1cEltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGhhbmRsZUNhcmRDbGljayA9ICh7IG5hbWUsIGxpbmsgfSkgPT4ge1xuICAgIHBvcHVwSW1hZ2Uub3BlbihuYW1lLCBsaW5rKTtcbn07XG5cbmNvbnN0IGNhcmRzTGlzdCA9IG5ldyBTZWN0aW9uKHtcbiAgICBpdGVtczogaW5pdGlhbENhcmRzLFxuICAgIHJlbmRlcmVyOiAoaXRlbSkgPT4ge1xuICAgICAgICBjb25zdCBjYXJkID0gbmV3IENhcmQoaXRlbS5uYW1lLCBpdGVtLmxpbmssIGdlbmVyYXRlQ2FyZFRlbXBsYXRlKCksIGhhbmRsZUNhcmRDbGljayk7XG5cbiAgICAgICAgY29uc3QgY2FyZEVsZW1lbnQgPSBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xuXG4gICAgICAgIGNhcmRzTGlzdC5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbiAgICB9XG59LFxuICAgICcuZWxlbWVudCdcbik7XG5cbmNhcmRzTGlzdC5yZW5kZXJJdGVtcygpO1xuXG5jb25zdCBnZXRDYXJkRWxlbWVudCA9ICh7IG5hbWUsIGxpbmsgfSkgPT4ge1xuICAgIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChuYW1lLCBsaW5rLCBnZW5lcmF0ZUNhcmRUZW1wbGF0ZSgpLCBoYW5kbGVDYXJkQ2xpY2spO1xuICAgIHJldHVybiBjYXJkLmdlbmVyYXRlQ2FyZCgpO1xufVxuXG5jb25zdCBmb3JtQWRkID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xuICAgIHBvcHVwU2VsZWN0b3I6ICcucG9wdXBfdHlwZV9hZGQnLFxuICAgIGhhbmRsZUZvcm1TdWJtaXQ6IChpbnB1dFZhbHVlcykgPT4ge1xuICAgICAgICBjYXJkc0xpc3QuYWRkSXRlbSh7IG5hbWU6IGlucHV0VmFsdWVzLnRpdGxlLCBsaW5rOiBpbnB1dFZhbHVlcy5waWN0dXJlIH0pO1xuICAgICAgICBmb3JtQWRkLmNsb3NlKCk7XG4gICAgfVxufSk7XG5cbmZvcm1BZGQuc2V0RXZlbnRMaXN0ZW5lcnMoZm9ybUVkaXQpO1xuXG5hZGRDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIGZvcm1BZGQub3BlbigpO1xuXG4gICAgY29uc3QgaW5wdXRMaXN0ID0gQXJyYXkuZnJvbShwb3B1cEFkZC5xdWVyeVNlbGVjdG9yQWxsKCcucG9wdXBfX2ZpZWxkJykpO1xuICAgIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSBwb3B1cEFkZC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX3N1Ym1pdC1idXR0b24nKTtcblxuICAgIGZvcm1BZGRWYWxpZGF0b3IudG9nZ2xlQnV0dG9uU3RhdGUoaW5wdXRMaXN0LCBidXR0b25FbGVtZW50KTtcbn0pO1xuXG5jb25zdCBmb3JtRWRpdCA9IG5ldyBQb3B1cFdpdGhGb3JtKHtcbiAgICBwb3B1cFNlbGVjdG9yOiAnLnBvcHVwX3R5cGVfZWRpdCcsXG4gICAgaGFuZGxlRm9ybVN1Ym1pdDogKGlucHV0c1ZhbHVlcykgPT4ge1xuICAgICAgICB1c2VySW5mby5zZXRVc2VySW5mbyh7IG5hbWU6IGlucHV0c1ZhbHVlcy5mdWxsbmFtZSwgam9iOiBpbnB1dHNWYWx1ZXMuam9iIH0pO1xuICAgICAgICBmb3JtRWRpdC5jbG9zZSgpO1xuICAgIH1cblxufSk7XG5cbnByb2ZpbGVFZGl0QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIGNvbnN0IHByb2ZpbGUgPSB1c2VySW5mby5nZXRVc2VySW5mbygpO1xuICAgIGNvbnN0IGlucHV0c05hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ZpZWxkX2lucHV0X25hbWUnKTtcbiAgICBjb25zdCBpbnB1dHNKb2IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ZpZWxkX2lucHV0X2pvYicpO1xuXG4gICAgaW5wdXRzTmFtZS52YWx1ZSA9IHByb2ZpbGUubmFtZTtcbiAgICBpbnB1dHNKb2IudmFsdWUgPSBwcm9maWxlLmpvYklucHV0O1xuXG4gICAgZm9ybUVkaXQub3BlbigpO1xufSk7XG5cbmZvcm1FZGl0LnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IGZvcm1BZGRWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihwYXJhbXMsIHBhcmFtcy5mb3JtQWRkKTtcbmZvcm1BZGRWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCBmb3JtRWRpdFZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKHBhcmFtcywgcGFyYW1zLmZvcm1FZGl0KTtcbmZvcm1FZGl0VmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuXG4iXSwic291cmNlUm9vdCI6IiJ9