(()=>{"use strict";function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var t=function(){function t(e,n,r,o){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),this._name=e,this._link=n,this._template=r,this._handleCardClick=o}var n,r;return n=t,(r=[{key:"generateCard",value:function(){return this._element=this._template,this._image=this._element.querySelector(".element__image"),this._image.src=this._link,this._image.alt=this._name,this._element.querySelector(".element__title").textContent=this._name,this._setEventListeners(),this._element}},{key:"_handleDeleteCard",value:function(){this._element.remove()}},{key:"_setEventListeners",value:function(){var e=this;this._element.querySelector(".element__delete-button").addEventListener("click",(function(){e._handleDeleteCard()})),this._element.querySelector(".element__like-image").addEventListener("click",(function(e){e.target.classList.toggle("element__like-image-active")})),this._image.addEventListener("click",(function(){return e._handleCardClick({name:e._name,link:e._link})}))}}])&&e(n.prototype,r),t}(),n={formSelector:".popup__form",inputSelector:".popup__field",formAdd:".popup_type_add",formEdit:".popup_type_edit",submitButtonSelector:".popup__submit-button",inactiveButtonClass:"popup__submit-button-disabled",inputErrorClass:"popup__field-error",errorClass:"popup__field-error-active"},r=(document.querySelector(".popup__image"),document.querySelector(".popup__caption"),document.querySelector(".popup_type_add")),o=document.querySelector(".profile__edit-button"),i=document.querySelector(".profile__add-button"),u=document.querySelector(".popup__field_input_name"),c=document.querySelector(".popup__field_input_job");function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var l=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._formElement=document.querySelector(n),this._inputSelector=t.inputSelector,this._submitButtonSelector=t.submitButtonSelector,this._inactiveButtonClass=t.inactiveButtonClass,this._inputErrorClass=t.inputErrorClass,this._errorClass=t.errorClass}var t,n;return t=e,(n=[{key:"_showInputError",value:function(e,t){var n=this._formElement.querySelector("#".concat(e.id,"-error"));n.classList.add(this._errorClass),n.textContent=t}},{key:"_hideInputError",value:function(e){var t=this._formElement.querySelector("#".concat(e.id,"-error"));e.classList.remove(this._errorClass),t.textContent=""}},{key:"_checkInputValidity",value:function(e){e.validity.valid?this._hideInputError(e):this._showInputError(e,e.validationMessage)}},{key:"_hasInvalidInput",value:function(e){return e.some((function(e){return!e.validity.valid}))}},{key:"toggleButtonState",value:function(e,t){this._hasInvalidInput(e)?(t.classList.add(this._inactiveButtonClass),t.setAttribute("disabled",!0)):(t.classList.remove(this._inactiveButtonClass),t.removeAttribute("disabled"))}},{key:"_setEventListeners",value:function(){var e=this,t=Array.from(this._formElement.querySelectorAll(this._inputSelector)),n=this._formElement.querySelector(this._submitButtonSelector);t.forEach((function(r){r.addEventListener("input",(function(){e._checkInputValidity(r),e.toggleButtonState(t,n)}))}))}},{key:"enableValidation",value:function(){this._formElement.addEventListener("submit",(function(e){e.preventDefault()})),this._setEventListeners()}}])&&a(t.prototype,n),e}();function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var p=function(){function e(t,n){var r=t.items,o=t.renderer;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._renderedItems=r,this._renderer=o,this._container=document.querySelector(n)}var t,n;return t=e,(n=[{key:"renderItems",value:function(){var e=this;this._renderedItems.forEach((function(t){return e._renderer(t)}))}},{key:"addItem",value:function(e){this._container.prepend(e)}}])&&s(t.prototype,n),e}();function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var d=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._popup=document.querySelector(t),this._handleEscClose=this._handleEscClose.bind(this)}var t,n;return t=e,(n=[{key:"open",value:function(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleEscClose)}},{key:"close",value:function(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleEscClose)}},{key:"_handleEscClose",value:function(e){"Escape"===e.key&&this.close()}},{key:"setEventListeners",value:function(e){var t=this;this._popup.querySelector(".popup__close").addEventListener("click",(function(){return t.close()})),this._popup.addEventListener("click",(function(e){e.target===e.currentTarget&&t.close(e.currentTarget)}))}}])&&f(t.prototype,n),e}();function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t,n){return(m="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=b(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e,t){return!t||"object"!==y(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=b(r);if(o){var n=b(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return v(this,e)});function u(e,t,n){var r;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(r=i.call(this,e))._popupImage=document.querySelector(t),r._popupTitle=document.querySelector(n),r}return t=u,(n=[{key:"open",value:function(e,t){this._popupImage.src=t,this._popupTitle.textContent=e,m(b(u.prototype),"open",this).call(this)}}])&&_(t.prototype,n),u}(d);function S(e){return(S="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function k(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function E(e,t,n){return(E="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=j(e)););return e}(e,t);if(r){var o=Object.getOwnPropertyDescriptor(r,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function w(e,t){return(w=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function C(e,t){return!t||"object"!==S(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var O=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&w(e,t)}(u,e);var t,n,r,o,i=(r=u,o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}(),function(){var e,t=j(r);if(o){var n=j(this).constructor;e=Reflect.construct(t,arguments,n)}else e=t.apply(this,arguments);return C(this,e)});function u(e){var t,n=e.popupSelector,r=e.handleFormSubmit;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,u),(t=i.call(this,n))._handleFormSubmit=r,t}return t=u,(n=[{key:"_getInputValues",value:function(){var e=this,t=document.querySelectorAll(".popup__field");return this._inputValues={},t.forEach((function(t){e._inputValues[t.name]=t.value})),this._inputValues}},{key:"close",value:function(){E(j(u.prototype),"close",this).call(this),this._popup.querySelector("form").reset()}},{key:"setEventListeners",value:function(e){var t=this;E(j(u.prototype),"setEventListeners",this).call(this,e),this._popup.addEventListener("submit",(function(e){e.preventDefault(),t._handleFormSubmit(t._getInputValues())}))}}])&&k(t.prototype,n),u}(d);function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var L=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.titleSelector=document.querySelector(".profile__title"),this.subtitleSelector=document.querySelector(".profile__subtitle")}var t,n;return t=e,(n=[{key:"getUserInfo",value:function(){return{name:this.titleSelector.textContent,jobInput:this.subtitleSelector.textContent}}},{key:"setUserInfo",value:function(e){var t=e.name,n=e.job;this.titleSelector.textContent=t,this.subtitleSelector.textContent=n}}])&&q(t.prototype,n),e}()),I=new g(".popup_type_img",".popup__image",".popup__caption");I.setEventListeners();var P=function(e){var t=e.name,n=e.link;I.open(t,n)},x=function(e){var n=e.name,r=e.link;return new t(n,r,document.querySelector("#elements").content.querySelector(".element__cards").cloneNode(!0),P).generateCard()},R=new p({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:function(e){var t=x({name:e.name,link:e.link});R.addItem(t)}},".element");R.renderItems();var T=new O({popupSelector:".popup_type_add",handleFormSubmit:function(e){var t=x({name:e.title,link:e.picture});R.addItem(t),T.close()}});T.setEventListeners(B),i.addEventListener("click",(function(){T.open();var e=Array.from(r.querySelectorAll(".popup__field")),t=r.querySelector(".popup__submit-button");D.toggleButtonState(e,t)}));var B=new O({popupSelector:".popup_type_edit",handleFormSubmit:function(e){L.setUserInfo({name:e.fullname,job:e.job}),B.close()}});o.addEventListener("click",(function(){var e=L.getUserInfo();u.value=e.name,c.value=e.jobInput,B.open()})),B.setEventListeners();var D=new l(n,n.formAdd);D.enableValidation(),new l(n,n.formEdit).enableValidation()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvdXRpbHMvY29uc3RhbnQuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Gb3JtVmFsaWRhdG9yLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9tZXN0by8uL3NyYy9jb21wb25lbnRzL1BvcHVwLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL21lc3RvLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vbWVzdG8vLi9zcmMvcGFnZXMvaW5kZXguanMiXSwibmFtZXMiOlsiQ2FyZCIsIm5hbWUiLCJsaW5rIiwidGVtcGxhdGUiLCJoYW5kbGVDYXJkQ2xpY2siLCJ0aGlzIiwiX25hbWUiLCJfbGluayIsIl90ZW1wbGF0ZSIsIl9oYW5kbGVDYXJkQ2xpY2siLCJfZWxlbWVudCIsIl9pbWFnZSIsInF1ZXJ5U2VsZWN0b3IiLCJzcmMiLCJhbHQiLCJ0ZXh0Q29udGVudCIsIl9zZXRFdmVudExpc3RlbmVycyIsInJlbW92ZSIsImFkZEV2ZW50TGlzdGVuZXIiLCJfaGFuZGxlRGVsZXRlQ2FyZCIsImV2ZW50IiwidGFyZ2V0IiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwicGFyYW1zIiwiZm9ybVNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsImZvcm1BZGQiLCJmb3JtRWRpdCIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJwb3B1cEFkZCIsImRvY3VtZW50IiwicHJvZmlsZUVkaXRCdXR0b24iLCJhZGRDYXJkQnV0dG9uIiwiaW5wdXRzTmFtZSIsImlucHV0c0pvYiIsIkZvcm1WYWxpZGF0b3IiLCJmb3JtRWxlbWVudCIsIl9mb3JtRWxlbWVudCIsIl9pbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJpbnB1dEVsZW1lbnQiLCJlcnJvck1lc3NhZ2UiLCJlcnJvckVsZW1lbnQiLCJpZCIsImFkZCIsInZhbGlkaXR5IiwidmFsaWQiLCJfaGlkZUlucHV0RXJyb3IiLCJfc2hvd0lucHV0RXJyb3IiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsImlucHV0TGlzdCIsInNvbWUiLCJidXR0b25FbGVtZW50IiwiX2hhc0ludmFsaWRJbnB1dCIsInNldEF0dHJpYnV0ZSIsInJlbW92ZUF0dHJpYnV0ZSIsIkFycmF5IiwiZnJvbSIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJmb3JFYWNoIiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInRvZ2dsZUJ1dHRvblN0YXRlIiwicHJldmVudERlZmF1bHQiLCJTZWN0aW9uIiwiY29udGFpbmVyU2VsZWN0b3IiLCJpdGVtcyIsInJlbmRlcmVyIiwiX3JlbmRlcmVkSXRlbXMiLCJfcmVuZGVyZXIiLCJfY29udGFpbmVyIiwiaXRlbSIsImVsZW1lbnQiLCJwcmVwZW5kIiwiUG9wdXAiLCJwb3B1cFNlbGVjdG9yIiwiX3BvcHVwIiwiX2hhbmRsZUVzY0Nsb3NlIiwiYmluZCIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJrZXkiLCJjbG9zZSIsInBvcHVwIiwiY3VycmVudFRhcmdldCIsIlBvcHVwV2l0aEltYWdlIiwicG9wdXBJbWFnZSIsInBvcHVwVGl0bGUiLCJfcG9wdXBJbWFnZSIsIl9wb3B1cFRpdGxlIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJfaGFuZGxlRm9ybVN1Ym1pdCIsInVzZXJJbnB1dHMiLCJfaW5wdXRWYWx1ZXMiLCJ2YWx1ZSIsInJlc2V0IiwiX2dldElucHV0VmFsdWVzIiwidXNlckluZm8iLCJ0aXRsZVNlbGVjdG9yIiwic3VidGl0bGVTZWxlY3RvciIsImpvYklucHV0Iiwiam9iIiwic2V0RXZlbnRMaXN0ZW5lcnMiLCJvcGVuIiwiZ2V0Q2FyZEVsZW1lbnQiLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiZ2VuZXJhdGVDYXJkIiwiY2FyZHNMaXN0IiwiY2FyZEVsZW1lbnQiLCJhZGRJdGVtIiwicmVuZGVySXRlbXMiLCJpbnB1dFZhbHVlcyIsInRpdGxlIiwicGljdHVyZSIsImZvcm1BZGRWYWxpZGF0b3IiLCJpbnB1dHNWYWx1ZXMiLCJzZXRVc2VySW5mbyIsImZ1bGxuYW1lIiwicHJvZmlsZSIsImdldFVzZXJJbmZvIiwiZW5hYmxlVmFsaWRhdGlvbiJdLCJtYXBwaW5ncyI6InlMQUFPLElBQU1BLEVBQWIsV0FDSSxXQUFZQyxFQUFNQyxFQUFNQyxFQUFVQyxJLDRGQUFpQixTQUMvQ0MsS0FBS0MsTUFBUUwsRUFDYkksS0FBS0UsTUFBUUwsRUFDYkcsS0FBS0csVUFBWUwsRUFDakJFLEtBQUtJLGlCQUFtQkwsRSxRQUxoQyxPLEVBQUEsRyxFQUFBLHNDQWlCUSxPQVJBQyxLQUFLSyxTQUFXTCxLQUFLRyxVQUNyQkgsS0FBS00sT0FBU04sS0FBS0ssU0FBU0UsY0FBYyxtQkFDMUNQLEtBQUtNLE9BQU9FLElBQU1SLEtBQUtFLE1BQ3ZCRixLQUFLTSxPQUFPRyxJQUFNVCxLQUFLQyxNQUN2QkQsS0FBS0ssU0FBU0UsY0FBYyxtQkFBbUJHLFlBQWNWLEtBQUtDLE1BRWxFRCxLQUFLVyxxQkFFRVgsS0FBS0ssV0FqQnBCLDBDQXFCUUwsS0FBS0ssU0FBU08sV0FyQnRCLDJDQXdCeUIsV0FDakJaLEtBQUtLLFNBQ0FFLGNBQWMsMkJBQ2RNLGlCQUFpQixTQUFTLFdBQ3ZCLEVBQUtDLHVCQUdiZCxLQUFLSyxTQUNBRSxjQUFjLHdCQUNkTSxpQkFBaUIsU0FBUyxTQUFBRSxHQUN2QkEsRUFBTUMsT0FBT0MsVUFBVUMsT0FBTyxpQ0FHdENsQixLQUFLTSxPQUNBTyxpQkFBaUIsU0FBUyxrQkFBTSxFQUFLVCxpQkFBaUIsQ0FBRVIsS0FBTSxFQUFLSyxNQUFPSixLQUFNLEVBQUtLLGdCLGlCQXRDbEcsS0MyQmFpQixFQUFTLENBQ2xCQyxhQUFjLGVBQ2RDLGNBQWUsZ0JBQ2ZDLFFBQVMsa0JBQ1RDLFNBQVUsbUJBQ1ZDLHFCQUFzQix3QkFDdEJDLG9CQUFxQixnQ0FDckJDLGdCQUFpQixxQkFDakJDLFdBQVksNkJBTUhDLEdBSGFDLFNBQVN0QixjQUFjLGlCQUN2QnNCLFNBQVN0QixjQUFjLG1CQUV6QnNCLFNBQVN0QixjQUFjLG9CQUVsQ3VCLEVBQW9CRCxTQUFTdEIsY0FBYyx5QkFDM0N3QixFQUFnQkYsU0FBU3RCLGNBQWMsd0JBRXZDeUIsRUFBYUgsU0FBU3RCLGNBQWMsNEJBQ3BDMEIsRUFBWUosU0FBU3RCLGNBQWMsMkIsc0tDL0N6QyxJQUFNMkIsRUFBYixXQUNJLFdBQVlmLEVBQVFnQixJLDRGQUFhLFNBQzdCbkMsS0FBS29DLGFBQWVQLFNBQVN0QixjQUFjNEIsR0FDM0NuQyxLQUFLcUMsZUFBaUJsQixFQUFPRSxjQUM3QnJCLEtBQUtzQyxzQkFBd0JuQixFQUFPSyxxQkFDcEN4QixLQUFLdUMscUJBQXVCcEIsRUFBT00sb0JBQ25DekIsS0FBS3dDLGlCQUFtQnJCLEVBQU9PLGdCQUMvQjFCLEtBQUt5QyxZQUFjdEIsRUFBT1EsVyxRQVBsQyxPLEVBQUEsRyxFQUFBLHVDQVVvQmUsRUFBY0MsR0FDMUIsSUFBTUMsRUFBZTVDLEtBQUtvQyxhQUFhN0IsY0FBbEIsV0FBb0NtQyxFQUFhRyxHQUFqRCxXQUVyQkQsRUFBYTNCLFVBQVU2QixJQUFJOUMsS0FBS3lDLGFBQ2hDRyxFQUFhbEMsWUFBY2lDLElBZG5DLHNDQWlCb0JELEdBQ1osSUFBTUUsRUFBZTVDLEtBQUtvQyxhQUFhN0IsY0FBbEIsV0FBb0NtQyxFQUFhRyxHQUFqRCxXQUVyQkgsRUFBYXpCLFVBQVVMLE9BQU9aLEtBQUt5QyxhQUNuQ0csRUFBYWxDLFlBQWMsS0FyQm5DLDBDQXdCd0JnQyxHQUNYQSxFQUFhSyxTQUFTQyxNQUd2QmhELEtBQUtpRCxnQkFBZ0JQLEdBRnJCMUMsS0FBS2tELGdCQUFnQlIsRUFBY0EsRUFBYVMscUJBMUI1RCx1Q0FnQ3FCQyxHQUNiLE9BQU9BLEVBQVVDLE1BQUssU0FBQ1gsR0FBRCxPQUFtQkEsRUFBYUssU0FBU0MsV0FqQ3ZFLHdDQW9Dc0JJLEVBQVdFLEdBQ3JCdEQsS0FBS3VELGlCQUFpQkgsSUFDdEJFLEVBQWNyQyxVQUFVNkIsSUFBSTlDLEtBQUt1QyxzQkFDakNlLEVBQWNFLGFBQWEsWUFBWSxLQUV2Q0YsRUFBY3JDLFVBQVVMLE9BQU9aLEtBQUt1QyxzQkFDcENlLEVBQWNHLGdCQUFnQixlQTFDMUMsMkNBOEN5QixXQUNYTCxFQUFZTSxNQUFNQyxLQUFLM0QsS0FBS29DLGFBQWF3QixpQkFBaUI1RCxLQUFLcUMsaUJBQy9EaUIsRUFBZ0J0RCxLQUFLb0MsYUFBYTdCLGNBQWNQLEtBQUtzQyx1QkFFM0RjLEVBQVVTLFNBQVEsU0FBQ25CLEdBQ2ZBLEVBQWE3QixpQkFBaUIsU0FBUyxXQUNuQyxFQUFLaUQsb0JBQW9CcEIsR0FDekIsRUFBS3FCLGtCQUFrQlgsRUFBV0UsV0FyRGxELHlDQThEUXRELEtBQUtvQyxhQUFhdkIsaUJBQWlCLFVBSFQsU0FBQ0UsR0FDdkJBLEVBQU1pRCxvQkFJVmhFLEtBQUtXLDBCLGlCQWhFYixLLHNLQ0FPLElBQU1zRCxFQUFiLFdBQ0ksYUFBaUNDLEdBQW1CLElBQXRDQyxFQUFzQyxFQUF0Q0EsTUFBT0MsRUFBK0IsRUFBL0JBLFUsNEZBQStCLFNBQ2hEcEUsS0FBS3FFLGVBQWlCRixFQUN0Qm5FLEtBQUtzRSxVQUFZRixFQUVqQnBFLEtBQUt1RSxXQUFhMUMsU0FBU3RCLGNBQWMyRCxHLFFBTGpELE8sRUFBQSxHLEVBQUEscUNBUWtCLFdBQ1ZsRSxLQUFLcUUsZUFBZVIsU0FBUSxTQUFBVyxHQUFJLE9BQUksRUFBS0YsVUFBVUUsUUFUM0QsOEJBWVlDLEdBQ0p6RSxLQUFLdUUsV0FBV0csUUFBUUQsUSxpQkFiaEMsSyxzS0NDTyxJQUFNRSxFQUFiLFdBQ0ksV0FBWUMsSSw0RkFBZSxTQUN2QjVFLEtBQUs2RSxPQUFTaEQsU0FBU3RCLGNBQWNxRSxHQUNyQzVFLEtBQUs4RSxnQkFBa0I5RSxLQUFLOEUsZ0JBQWdCQyxLQUFLL0UsTSxRQUh6RCxPLEVBQUEsRyxFQUFBLDhCQU9RQSxLQUFLNkUsT0FBTzVELFVBQVU2QixJQUFJLGdCQUMxQmpCLFNBQVNoQixpQkFBaUIsVUFBV2IsS0FBSzhFLG1CQVJsRCw4QkFZUTlFLEtBQUs2RSxPQUFPNUQsVUFBVUwsT0FBTyxnQkFDN0JpQixTQUFTbUQsb0JBQW9CLFVBQVdoRixLQUFLOEUsbUJBYnJELHNDQWdCb0JHLEdBQ1ksV0FBWkEsRUFBSUMsS0FDSmxGLEtBQUttRixVQWxCekIsd0NBc0JzQkMsR0FBTyxXQUNJcEYsS0FBSzZFLE9BQU90RSxjQUFjLGlCQUNsQ00saUJBQWlCLFNBQVMsa0JBQU0sRUFBS3NFLFdBR3REbkYsS0FBSzZFLE9BQU9oRSxpQkFBaUIsU0FBUyxTQUFDb0UsR0FDL0JBLEVBQUlqRSxTQUFXaUUsRUFBSUksZUFJdkIsRUFBS0YsTUFBTUYsRUFBSUksdUIsaUJBaEMzQixLLDhrQ0NDTyxJQUFNQyxFQUFiLGEsa09BQUEsVSxRQUFBLEcsRUFBQSxFLDBZQUNJLFdBQVlWLEVBQWVXLEVBQVlDLEdBQVksYSw0RkFBQSxVQUMvQyxjQUFNWixJQUNEYSxZQUFjNUQsU0FBU3RCLGNBQWNnRixHQUMxQyxFQUFLRyxZQUFjN0QsU0FBU3RCLGNBQWNpRixHQUhLLEVBRHZELE8sRUFBQSxHLEVBQUEsNEJBT1M1RixFQUFNQyxHQUNQRyxLQUFLeUYsWUFBWWpGLElBQU1YLEVBQ3ZCRyxLQUFLMEYsWUFBWWhGLFlBQWNkLEVBQy9CLDhDLGlCQVZSLEdBQW9DK0UsRyw4a0NDQTdCLElBQU1nQixFQUFiLGEsa09BQUEsVSxRQUFBLEcsRUFBQSxFLDBZQUNJLGNBQWlELE1BQW5DZixFQUFtQyxFQUFuQ0EsY0FBZWdCLEVBQW9CLEVBQXBCQSxpQkFBb0IsTyw0RkFBQSxVQUM3QyxjQUFNaEIsSUFDRGlCLGtCQUFvQkQsRUFGb0IsRUFEckQsTyxFQUFBLEcsRUFBQSx5Q0FNc0IsV0FDUkUsRUFBYWpFLFNBQVMrQixpQkFBaUIsaUJBSzdDLE9BSkE1RCxLQUFLK0YsYUFBZSxHQUNwQkQsRUFBV2pDLFNBQVEsU0FBQ1csR0FDaEIsRUFBS3VCLGFBQWF2QixFQUFLNUUsTUFBUTRFLEVBQUt3QixTQUVqQ2hHLEtBQUsrRixlQVpwQiw4QkFnQlEsMENBQ0EvRixLQUFLNkUsT0FBT3RFLGNBQWMsUUFBUTBGLFVBakIxQyx3Q0FvQnNCYixHQUFPLFdBQ3JCLHFEQUF3QkEsR0FDeEJwRixLQUFLNkUsT0FBT2hFLGlCQUFpQixVQUFVLFNBQUNvRSxHQUNwQ0EsRUFBSWpCLGlCQUNKLEVBQUs2QixrQkFBa0IsRUFBS0ssMkIsaUJBeEJ4QyxHQUFtQ3ZCLEcsc0tDRjVCLElDU0R3QixFQUFXLElEVGpCLFdBQ0ksYyw0RkFBYyxTQUNWbkcsS0FBS29HLGNBQWdCdkUsU0FBU3RCLGNBQWMsbUJBQzVDUCxLQUFLcUcsaUJBQW1CeEUsU0FBU3RCLGNBQWMsc0IsUUFIdkQsTyxFQUFBLEcsRUFBQSxxQ0FPUSxNQUFPLENBQ0hYLEtBQU1JLEtBQUtvRyxjQUFjMUYsWUFDekI0RixTQUFVdEcsS0FBS3FHLGlCQUFpQjNGLGVBVDVDLHFDQWErQixJQUFiZCxFQUFhLEVBQWJBLEtBQU0yRyxFQUFPLEVBQVBBLElBQ2hCdkcsS0FBS29HLGNBQWMxRixZQUFjZCxFQUNqQ0ksS0FBS3FHLGlCQUFpQjNGLFlBQWM2RixPLGlCQWY1QyxNQ2lCTWhCLEVBQWEsSUFBSUQsRUFBZSxrQkFBbUIsZ0JBQWlCLG1CQUMxRUMsRUFBV2lCLG9CQUVYLElBQU16RyxFQUFrQixTQUFDLEdBQW1CLElBQWpCSCxFQUFpQixFQUFqQkEsS0FBTUMsRUFBVyxFQUFYQSxLQUM3QjBGLEVBQVdrQixLQUFLN0csRUFBTUMsSUFHcEI2RyxFQUFpQixTQUFDLEdBQW1CLElBQWpCOUcsRUFBaUIsRUFBakJBLEtBQU1DLEVBQVcsRUFBWEEsS0FFNUIsT0FEYSxJQUFJRixFQUFLQyxFQUFNQyxFQWRHZ0MsU0FDOUJ0QixjQUFjLGFBQ2RvRyxRQUNBcEcsY0FBYyxtQkFDZHFHLFdBQVUsR0FVK0M3RyxHQUM5QzhHLGdCQUdWQyxFQUFZLElBQUk3QyxFQUFRLENBQzFCRSxNUDlCd0IsQ0FDeEIsQ0FDSXZFLEtBQU0sUUFDTkMsS0FBTSxpRkFFVixDQUNJRCxLQUFNLHNCQUNOQyxLQUFNLDZGQUVWLENBQ0lELEtBQU0sVUFDTkMsS0FBTSxrRkFFVixDQUNJRCxLQUFNLFdBQ05DLEtBQU0sb0ZBRVYsQ0FDSUQsS0FBTSxxQkFDTkMsS0FBTSw2RkFFVixDQUNJRCxLQUFNLFNBQ05DLEtBQU0sa0ZPUVZ1RSxTQUFVLFNBQUNJLEdBQ1AsSUFBTXVDLEVBQWNMLEVBQWUsQ0FBQzlHLEtBQU00RSxFQUFLNUUsS0FBTUMsS0FBTTJFLEVBQUszRSxPQUNoRWlILEVBQVVFLFFBQVFELEtBR3RCLFlBR0pELEVBQVVHLGNBRVYsSUFBTTNGLEVBQVUsSUFBSXFFLEVBQWMsQ0FDOUJmLGNBQWUsa0JBQ2ZnQixpQkFBa0IsU0FBQ3NCLEdBQ2YsSUFBTUgsRUFBY0wsRUFBZSxDQUFFOUcsS0FBTXNILEVBQVlDLE1BQU90SCxLQUFNcUgsRUFBWUUsVUFDaEZOLEVBQVVFLFFBQVFELEdBQ2xCekYsRUFBUTZELFdBSWhCN0QsRUFBUWtGLGtCQUFrQmpGLEdBRTFCUSxFQUFjbEIsaUJBQWlCLFNBQVMsV0FDcENTLEVBQVFtRixPQUVSLElBQU1yRCxFQUFZTSxNQUFNQyxLQUFLL0IsRUFBU2dDLGlCQUFpQixrQkFDakROLEVBQWdCMUIsRUFBU3JCLGNBQWMseUJBRTdDOEcsRUFBaUJ0RCxrQkFBa0JYLEVBQVdFLE1BR2xELElBQU0vQixFQUFXLElBQUlvRSxFQUFjLENBQy9CZixjQUFlLG1CQUNmZ0IsaUJBQWtCLFNBQUMwQixHQUNmbkIsRUFBU29CLFlBQVksQ0FBRTNILEtBQU0wSCxFQUFhRSxTQUFVakIsSUFBS2UsRUFBYWYsTUFDdEVoRixFQUFTNEQsV0FLakJyRCxFQUFrQmpCLGlCQUFpQixTQUFTLFdBQ3hDLElBQU00RyxFQUFVdEIsRUFBU3VCLGNBRXpCMUYsUUFBbUJ5RixFQUFRN0gsS0FDM0JxQyxRQUFrQndGLEVBQVFuQixTQUUxQi9FLEVBQVNrRixVQUdibEYsRUFBU2lGLG9CQUVULElBQU1hLEVBQW1CLElBQUluRixFQUFjZixFQUFRQSxFQUFPRyxTQUMxRCtGLEVBQWlCTSxtQkFFUyxJQUFJekYsRUFBY2YsRUFBUUEsRUFBT0ksVUFDekNvRyxvQiIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGNsYXNzIENhcmQge1xuICAgIGNvbnN0cnVjdG9yKG5hbWUsIGxpbmssIHRlbXBsYXRlLCBoYW5kbGVDYXJkQ2xpY2spIHtcbiAgICAgICAgdGhpcy5fbmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMuX2xpbmsgPSBsaW5rO1xuICAgICAgICB0aGlzLl90ZW1wbGF0ZSA9IHRlbXBsYXRlO1xuICAgICAgICB0aGlzLl9oYW5kbGVDYXJkQ2xpY2sgPSBoYW5kbGVDYXJkQ2xpY2s7XG4gICAgfVxuXG4gICAgZ2VuZXJhdGVDYXJkKCkge1xuICAgICAgICB0aGlzLl9lbGVtZW50ID0gdGhpcy5fdGVtcGxhdGU7XG4gICAgICAgIHRoaXMuX2ltYWdlID0gdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9faW1hZ2UnKTtcbiAgICAgICAgdGhpcy5faW1hZ2Uuc3JjID0gdGhpcy5fbGluaztcbiAgICAgICAgdGhpcy5faW1hZ2UuYWx0ID0gdGhpcy5fbmFtZTtcbiAgICAgICAgdGhpcy5fZWxlbWVudC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9fdGl0bGUnKS50ZXh0Q29udGVudCA9IHRoaXMuX25hbWU7XG5cbiAgICAgICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuICAgICAgICByZXR1cm4gdGhpcy5fZWxlbWVudDtcbiAgICB9XG5cbiAgICBfaGFuZGxlRGVsZXRlQ2FyZCgpIHtcbiAgICAgICAgdGhpcy5fZWxlbWVudC5yZW1vdmUoKTtcbiAgICB9XG5cbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIHRoaXMuX2VsZW1lbnRcbiAgICAgICAgICAgIC5xdWVyeVNlbGVjdG9yKCcuZWxlbWVudF9fZGVsZXRlLWJ1dHRvbicpXG4gICAgICAgICAgICAuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5faGFuZGxlRGVsZXRlQ2FyZCgpO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy5fZWxlbWVudFxuICAgICAgICAgICAgLnF1ZXJ5U2VsZWN0b3IoJy5lbGVtZW50X19saWtlLWltYWdlJylcbiAgICAgICAgICAgIC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGV2ZW50ID0+IHtcbiAgICAgICAgICAgICAgICBldmVudC50YXJnZXQuY2xhc3NMaXN0LnRvZ2dsZSgnZWxlbWVudF9fbGlrZS1pbWFnZS1hY3RpdmUnKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIHRoaXMuX2ltYWdlXG4gICAgICAgICAgICAuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB0aGlzLl9oYW5kbGVDYXJkQ2xpY2soeyBuYW1lOiB0aGlzLl9uYW1lLCBsaW5rOiB0aGlzLl9saW5rfSkpO1xuICAgIH1cbn0gIiwiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAgICB7XG4gICAgICAgIG5hbWU6ICfQkNGA0YXRi9C3JyxcbiAgICAgICAgbGluazogJ2h0dHBzOi8vcGljdHVyZXMuczMueWFuZGV4Lm5ldC9mcm9udGVuZC1kZXZlbG9wZXIvY2FyZHMtY29tcHJlc3NlZC9hcmtoeXouanBnJ1xuICAgIH0sXG4gICAge1xuICAgICAgICBuYW1lOiAn0KfQtdC70Y/QsdC40L3RgdC60LDRjyDQvtCx0LvQsNGB0YLRjCcsXG4gICAgICAgIGxpbms6ICdodHRwczovL3BpY3R1cmVzLnMzLnlhbmRleC5uZXQvZnJvbnRlbmQtZGV2ZWxvcGVyL2NhcmRzLWNvbXByZXNzZWQvY2hlbHlhYmluc2stb2JsYXN0LmpwZydcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogJ9CY0LLQsNC90L7QstC+JyxcbiAgICAgICAgbGluazogJ2h0dHBzOi8vcGljdHVyZXMuczMueWFuZGV4Lm5ldC9mcm9udGVuZC1kZXZlbG9wZXIvY2FyZHMtY29tcHJlc3NlZC9pdmFub3ZvLmpwZydcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogJ9Ca0LDQvNGH0LDRgtC60LAnLFxuICAgICAgICBsaW5rOiAnaHR0cHM6Ly9waWN0dXJlcy5zMy55YW5kZXgubmV0L2Zyb250ZW5kLWRldmVsb3Blci9jYXJkcy1jb21wcmVzc2VkL2thbWNoYXRrYS5qcGcnXG4gICAgfSxcbiAgICB7XG4gICAgICAgIG5hbWU6ICfQpdC+0LvQvNC+0LPQvtGA0YHQutC40Lkg0YDQsNC50L7QvScsXG4gICAgICAgIGxpbms6ICdodHRwczovL3BpY3R1cmVzLnMzLnlhbmRleC5uZXQvZnJvbnRlbmQtZGV2ZWxvcGVyL2NhcmRzLWNvbXByZXNzZWQva2hvbG1vZ29yc2t5LXJheW9uLmpwZydcbiAgICB9LFxuICAgIHtcbiAgICAgICAgbmFtZTogJ9CR0LDQudC60LDQuycsXG4gICAgICAgIGxpbms6ICdodHRwczovL3BpY3R1cmVzLnMzLnlhbmRleC5uZXQvZnJvbnRlbmQtZGV2ZWxvcGVyL2NhcmRzLWNvbXByZXNzZWQvYmFpa2FsLmpwZydcbiAgICB9XG5dO1xuXG5leHBvcnQgY29uc3QgcGFyYW1zID0ge1xuICAgIGZvcm1TZWxlY3RvcjogJy5wb3B1cF9fZm9ybScsXG4gICAgaW5wdXRTZWxlY3RvcjogJy5wb3B1cF9fZmllbGQnLFxuICAgIGZvcm1BZGQ6ICcucG9wdXBfdHlwZV9hZGQnLFxuICAgIGZvcm1FZGl0OiAnLnBvcHVwX3R5cGVfZWRpdCcsXG4gICAgc3VibWl0QnV0dG9uU2VsZWN0b3I6ICcucG9wdXBfX3N1Ym1pdC1idXR0b24nLFxuICAgIGluYWN0aXZlQnV0dG9uQ2xhc3M6ICdwb3B1cF9fc3VibWl0LWJ1dHRvbi1kaXNhYmxlZCcsXG4gICAgaW5wdXRFcnJvckNsYXNzOiAncG9wdXBfX2ZpZWxkLWVycm9yJyxcbiAgICBlcnJvckNsYXNzOiAncG9wdXBfX2ZpZWxkLWVycm9yLWFjdGl2ZSdcbn1cblxuZXhwb3J0IGNvbnN0IHBvcHVwSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfX2ltYWdlJyk7XG5leHBvcnQgY29uc3QgcG9wdXBUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wb3B1cF9fY2FwdGlvbicpO1xuXG5leHBvcnQgY29uc3QgcG9wdXBBZGQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucG9wdXBfdHlwZV9hZGQnKTtcblxuZXhwb3J0IGNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnByb2ZpbGVfX2VkaXQtYnV0dG9uJyk7XG5leHBvcnQgY29uc3QgYWRkQ2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX19hZGQtYnV0dG9uJyk7XG5cbmV4cG9ydCBjb25zdCBpbnB1dHNOYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19maWVsZF9pbnB1dF9uYW1lJyk7XG5leHBvcnQgY29uc3QgaW5wdXRzSm9iID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnBvcHVwX19maWVsZF9pbnB1dF9qb2InKTsiLCJleHBvcnQgY2xhc3MgRm9ybVZhbGlkYXRvciB7XG4gICAgY29uc3RydWN0b3IocGFyYW1zLCBmb3JtRWxlbWVudCkge1xuICAgICAgICB0aGlzLl9mb3JtRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoZm9ybUVsZW1lbnQpO1xuICAgICAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gcGFyYW1zLmlucHV0U2VsZWN0b3I7XG4gICAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yID0gcGFyYW1zLnN1Ym1pdEJ1dHRvblNlbGVjdG9yO1xuICAgICAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gcGFyYW1zLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHBhcmFtcy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgICAgIHRoaXMuX2Vycm9yQ2xhc3MgPSBwYXJhbXMuZXJyb3JDbGFzcztcbiAgICB9XG5cbiAgICBfc2hvd0lucHV0RXJyb3IoaW5wdXRFbGVtZW50LCBlcnJvck1lc3NhZ2UpIHtcbiAgICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuXG4gICAgICAgIGVycm9yRWxlbWVudC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSBlcnJvck1lc3NhZ2U7XG4gICAgfTtcblxuICAgIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICAgICAgY29uc3QgZXJyb3JFbGVtZW50ID0gdGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihgIyR7aW5wdXRFbGVtZW50LmlkfS1lcnJvcmApO1xuXG4gICAgICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICAgICAgICBlcnJvckVsZW1lbnQudGV4dENvbnRlbnQgPSAnJztcbiAgICB9O1xuXG4gICAgX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpIHtcbiAgICAgICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgICAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCwgaW5wdXRFbGVtZW50LnZhbGlkYXRpb25NZXNzYWdlKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgX2hhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpIHtcbiAgICAgICAgcmV0dXJuIGlucHV0TGlzdC5zb21lKChpbnB1dEVsZW1lbnQpID0+ICFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpO1xuICAgIH07XG5cbiAgICB0b2dnbGVCdXR0b25TdGF0ZShpbnB1dExpc3QsIGJ1dHRvbkVsZW1lbnQpIHtcbiAgICAgICAgaWYgKHRoaXMuX2hhc0ludmFsaWRJbnB1dChpbnB1dExpc3QpKSB7XG4gICAgICAgICAgICBidXR0b25FbGVtZW50LmNsYXNzTGlzdC5hZGQodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgICAgICAgICBidXR0b25FbGVtZW50LnNldEF0dHJpYnV0ZShcImRpc2FibGVkXCIsIHRydWUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYnV0dG9uRWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgICAgICAgICAgYnV0dG9uRWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoXCJkaXNhYmxlZFwiKTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgICAgIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20odGhpcy5fZm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKSk7XG4gICAgICAgIGNvbnN0IGJ1dHRvbkVsZW1lbnQgPSB0aGlzLl9mb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcblxuICAgICAgICBpbnB1dExpc3QuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICAgICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsICgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLl9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KTtcbiAgICAgICAgICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICAgICAgY29uc3Qgc3VibWl0Rm9ybUhhbmRsZXIgPSAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgc3VibWl0Rm9ybUhhbmRsZXIpO1xuXG4gICAgICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgfTtcbn0iLCJleHBvcnQgY2xhc3MgU2VjdGlvbiB7XG4gICAgY29uc3RydWN0b3IoeyBpdGVtcywgcmVuZGVyZXIgfSwgY29udGFpbmVyU2VsZWN0b3IpIHtcbiAgICAgICAgdGhpcy5fcmVuZGVyZWRJdGVtcyA9IGl0ZW1zO1xuICAgICAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoY29udGFpbmVyU2VsZWN0b3IpO1xuICAgIH1cblxuICAgIHJlbmRlckl0ZW1zKCkge1xuICAgICAgICB0aGlzLl9yZW5kZXJlZEl0ZW1zLmZvckVhY2goaXRlbSA9PiB0aGlzLl9yZW5kZXJlcihpdGVtKSk7XG4gICAgfVxuXG4gICAgYWRkSXRlbShlbGVtZW50KSB7XG4gICAgICAgIHRoaXMuX2NvbnRhaW5lci5wcmVwZW5kKGVsZW1lbnQpO1xuICAgIH1cbn1cblxuIiwiXG5leHBvcnQgY2xhc3MgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICAgICAgdGhpcy5fcG9wdXAgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgICAgICB0aGlzLl9oYW5kbGVFc2NDbG9zZSA9IHRoaXMuX2hhbmRsZUVzY0Nsb3NlLmJpbmQodGhpcyk7XG4gICAgfVxuXG4gICAgb3BlbigpIHtcbiAgICAgICAgdGhpcy5fcG9wdXAuY2xhc3NMaXN0LmFkZCgncG9wdXBfb3BlbmVkJyk7XG4gICAgICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ2tleWRvd24nLCB0aGlzLl9oYW5kbGVFc2NDbG9zZSk7XG4gICAgfVxuXG4gICAgY2xvc2UoKSB7XG4gICAgICAgIHRoaXMuX3BvcHVwLmNsYXNzTGlzdC5yZW1vdmUoJ3BvcHVwX29wZW5lZCcpO1xuICAgICAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKCdrZXlkb3duJywgdGhpcy5faGFuZGxlRXNjQ2xvc2UpOyBcbiAgICB9XG5cbiAgICBfaGFuZGxlRXNjQ2xvc2UoZXZ0KSB7XG4gICAgICAgICAgICAgICAgaWYgKGV2dC5rZXkgPT09ICdFc2NhcGUnKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG5cbiAgICBzZXRFdmVudExpc3RlbmVycyhwb3B1cCkge1xuICAgICAgICBjb25zdCBwb3B1cENsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXAucXVlcnlTZWxlY3RvcignLnBvcHVwX19jbG9zZScpO1xuICAgICAgICBwb3B1cENsb3NlQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4gdGhpcy5jbG9zZSgpKTtcblxuXG4gICAgICAgIHRoaXMuX3BvcHVwLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKGV2dCkgPT4ge1xuICAgICAgICAgICAgaWYgKGV2dC50YXJnZXQgIT09IGV2dC5jdXJyZW50VGFyZ2V0KSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLmNsb3NlKGV2dC5jdXJyZW50VGFyZ2V0KTtcbiAgICAgICAgfSk7XG4gICAgfVxufVxuIiwiaW1wb3J0IHsgUG9wdXAgfSBmcm9tICcuL1BvcHVwLmpzJztcblxuZXhwb3J0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICAgIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIHBvcHVwSW1hZ2UsIHBvcHVwVGl0bGUpIHtcbiAgICAgICAgc3VwZXIocG9wdXBTZWxlY3Rvcik7XG4gICAgICAgIHRoaXMuX3BvcHVwSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwSW1hZ2UpO1xuICAgICAgICB0aGlzLl9wb3B1cFRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3Rvcihwb3B1cFRpdGxlKTtcbiAgICB9XG5cbiAgICBvcGVuKG5hbWUsIGxpbmspIHtcbiAgICAgICAgdGhpcy5fcG9wdXBJbWFnZS5zcmMgPSBsaW5rO1xuICAgICAgICB0aGlzLl9wb3B1cFRpdGxlLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICAgICAgc3VwZXIub3BlbigpO1xuICAgIH1cbn0iLCJpbXBvcnQgeyBQb3B1cCB9IGZyb20gJy4vUG9wdXAuanMnO1xuXG5leHBvcnQgY2xhc3MgUG9wdXBXaXRoRm9ybSBleHRlbmRzIFBvcHVwIHtcbiAgICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQgfSkge1xuICAgICAgICBzdXBlcihwb3B1cFNlbGVjdG9yKTtcbiAgICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgfVxuXG4gICAgX2dldElucHV0VmFsdWVzKCkge1xuICAgICAgICBjb25zdCB1c2VySW5wdXRzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwX19maWVsZCcpO1xuICAgICAgICB0aGlzLl9pbnB1dFZhbHVlcyA9IHt9O1xuICAgICAgICB1c2VySW5wdXRzLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgICAgICAgIHRoaXMuX2lucHV0VmFsdWVzW2l0ZW0ubmFtZV0gPSBpdGVtLnZhbHVlO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHRoaXMuX2lucHV0VmFsdWVzO1xuICAgIH1cblxuICAgIGNsb3NlKCkge1xuICAgICAgICBzdXBlci5jbG9zZSgpO1xuICAgICAgICB0aGlzLl9wb3B1cC5xdWVyeVNlbGVjdG9yKCdmb3JtJykucmVzZXQoKTsgXG4gICAgfVxuXG4gICAgc2V0RXZlbnRMaXN0ZW5lcnMocG9wdXApIHtcbiAgICAgICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMocG9wdXApO1xuICAgICAgICB0aGlzLl9wb3B1cC5hZGRFdmVudExpc3RlbmVyKCdzdWJtaXQnLCAoZXZ0KSA9PiB7XG4gICAgICAgICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQodGhpcy5fZ2V0SW5wdXRWYWx1ZXMoKSk7XG4gICAgICAgIH0pXG4gICAgfVxufVxuXG5cbiIsImV4cG9ydCBjbGFzcyBVc2VySW5mbyB7XG4gICAgY29uc3RydWN0b3IoKSB7XG4gICAgICAgIHRoaXMudGl0bGVTZWxlY3RvciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5wcm9maWxlX190aXRsZScpO1xuICAgICAgICB0aGlzLnN1YnRpdGxlU2VsZWN0b3IgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucHJvZmlsZV9fc3VidGl0bGUnKTtcbiAgICB9XG5cbiAgICBnZXRVc2VySW5mbygpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG5hbWU6IHRoaXMudGl0bGVTZWxlY3Rvci50ZXh0Q29udGVudCxcbiAgICAgICAgICAgIGpvYklucHV0OiB0aGlzLnN1YnRpdGxlU2VsZWN0b3IudGV4dENvbnRlbnRcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNldFVzZXJJbmZvKHsgbmFtZSwgam9iIH0pIHtcbiAgICAgICAgdGhpcy50aXRsZVNlbGVjdG9yLnRleHRDb250ZW50ID0gbmFtZTtcbiAgICAgICAgdGhpcy5zdWJ0aXRsZVNlbGVjdG9yLnRleHRDb250ZW50ID0gam9iO1xuICAgIH1cbn1cbiIsImltcG9ydCB7IENhcmQgfSBmcm9tICcuLi9jb21wb25lbnRzL0NhcmQuanMnO1xuaW1wb3J0IHsgaW5pdGlhbENhcmRzLCBwYXJhbXMsIHBvcHVwQWRkLCBhZGRDYXJkQnV0dG9uLCBwcm9maWxlRWRpdEJ1dHRvbiwgaW5wdXRzTmFtZSwgaW5wdXRzSm9iIH0gZnJvbSAnLi4vdXRpbHMvY29uc3RhbnQuanMnO1xuaW1wb3J0IHsgRm9ybVZhbGlkYXRvciB9IGZyb20gJy4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyc7XG5pbXBvcnQgeyBTZWN0aW9uIH0gZnJvbSAnLi4vY29tcG9uZW50cy9TZWN0aW9uLmpzJztcbmltcG9ydCB7IFBvcHVwV2l0aEltYWdlIH0gZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhJbWFnZS5qcyc7XG5pbXBvcnQgeyBQb3B1cFdpdGhGb3JtIH0gZnJvbSAnLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzJztcbmltcG9ydCB7IFVzZXJJbmZvIH0gZnJvbSAnLi4vY29tcG9uZW50cy9Vc2VySW5mby5qcyc7XG5pbXBvcnQgJy4vaW5kZXguY3NzJztcblxuY29uc3QgdXNlckluZm8gPSBuZXcgVXNlckluZm8oKTtcblxuY29uc3QgZ2VuZXJhdGVDYXJkVGVtcGxhdGUgPSAoKSA9PiBkb2N1bWVudFxuICAgIC5xdWVyeVNlbGVjdG9yKFwiI2VsZW1lbnRzXCIpXG4gICAgLmNvbnRlbnRcbiAgICAucXVlcnlTZWxlY3RvcignLmVsZW1lbnRfX2NhcmRzJylcbiAgICAuY2xvbmVOb2RlKHRydWUpO1xuXG5jb25zdCBwb3B1cEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKCcucG9wdXBfdHlwZV9pbWcnLCAnLnBvcHVwX19pbWFnZScsICcucG9wdXBfX2NhcHRpb24nKTtcbnBvcHVwSW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgaGFuZGxlQ2FyZENsaWNrID0gKHsgbmFtZSwgbGluayB9KSA9PiB7XG4gICAgcG9wdXBJbWFnZS5vcGVuKG5hbWUsIGxpbmspO1xufTtcblxuY29uc3QgZ2V0Q2FyZEVsZW1lbnQgPSAoeyBuYW1lLCBsaW5rIH0pID0+IHtcbiAgICBjb25zdCBjYXJkID0gbmV3IENhcmQobmFtZSwgbGluaywgZ2VuZXJhdGVDYXJkVGVtcGxhdGUoKSwgaGFuZGxlQ2FyZENsaWNrKTtcbiAgICByZXR1cm4gY2FyZC5nZW5lcmF0ZUNhcmQoKTtcbn1cblxuY29uc3QgY2FyZHNMaXN0ID0gbmV3IFNlY3Rpb24oe1xuICAgIGl0ZW1zOiBpbml0aWFsQ2FyZHMsXG4gICAgcmVuZGVyZXI6IChpdGVtKSA9PiB7XG4gICAgICAgIGNvbnN0IGNhcmRFbGVtZW50ID0gZ2V0Q2FyZEVsZW1lbnQoe25hbWU6IGl0ZW0ubmFtZSwgbGluazogaXRlbS5saW5rfSk7XG4gICAgICAgIGNhcmRzTGlzdC5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbiAgICB9XG59LFxuICAgICcuZWxlbWVudCdcbik7XG5cbmNhcmRzTGlzdC5yZW5kZXJJdGVtcygpO1xuXG5jb25zdCBmb3JtQWRkID0gbmV3IFBvcHVwV2l0aEZvcm0oe1xuICAgIHBvcHVwU2VsZWN0b3I6ICcucG9wdXBfdHlwZV9hZGQnLFxuICAgIGhhbmRsZUZvcm1TdWJtaXQ6IChpbnB1dFZhbHVlcykgPT4ge1xuICAgICAgICBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KHsgbmFtZTogaW5wdXRWYWx1ZXMudGl0bGUsIGxpbms6IGlucHV0VmFsdWVzLnBpY3R1cmUgfSk7XG4gICAgICAgIGNhcmRzTGlzdC5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbiAgICAgICAgZm9ybUFkZC5jbG9zZSgpO1xuICAgIH1cbn0pO1xuXG5mb3JtQWRkLnNldEV2ZW50TGlzdGVuZXJzKGZvcm1FZGl0KTtcblxuYWRkQ2FyZEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBmb3JtQWRkLm9wZW4oKTtcblxuICAgIGNvbnN0IGlucHV0TGlzdCA9IEFycmF5LmZyb20ocG9wdXBBZGQucXVlcnlTZWxlY3RvckFsbCgnLnBvcHVwX19maWVsZCcpKTtcbiAgICBjb25zdCBidXR0b25FbGVtZW50ID0gcG9wdXBBZGQucXVlcnlTZWxlY3RvcignLnBvcHVwX19zdWJtaXQtYnV0dG9uJyk7XG5cbiAgICBmb3JtQWRkVmFsaWRhdG9yLnRvZ2dsZUJ1dHRvblN0YXRlKGlucHV0TGlzdCwgYnV0dG9uRWxlbWVudCk7XG59KTtcblxuY29uc3QgZm9ybUVkaXQgPSBuZXcgUG9wdXBXaXRoRm9ybSh7XG4gICAgcG9wdXBTZWxlY3RvcjogJy5wb3B1cF90eXBlX2VkaXQnLFxuICAgIGhhbmRsZUZvcm1TdWJtaXQ6IChpbnB1dHNWYWx1ZXMpID0+IHtcbiAgICAgICAgdXNlckluZm8uc2V0VXNlckluZm8oeyBuYW1lOiBpbnB1dHNWYWx1ZXMuZnVsbG5hbWUsIGpvYjogaW5wdXRzVmFsdWVzLmpvYiB9KTtcbiAgICAgICAgZm9ybUVkaXQuY2xvc2UoKTtcbiAgICB9XG5cbn0pO1xuXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBjb25zdCBwcm9maWxlID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcblxuICAgIGlucHV0c05hbWUudmFsdWUgPSBwcm9maWxlLm5hbWU7XG4gICAgaW5wdXRzSm9iLnZhbHVlID0gcHJvZmlsZS5qb2JJbnB1dDtcblxuICAgIGZvcm1FZGl0Lm9wZW4oKTtcbn0pO1xuXG5mb3JtRWRpdC5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBmb3JtQWRkVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IocGFyYW1zLCBwYXJhbXMuZm9ybUFkZCk7XG5mb3JtQWRkVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgZm9ybUVkaXRWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihwYXJhbXMsIHBhcmFtcy5mb3JtRWRpdCk7XG5mb3JtRWRpdFZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cblxuIl0sInNvdXJjZVJvb3QiOiIifQ==